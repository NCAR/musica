
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>TUV-x: Standard Configurations &#8212; MUSICA 0.14.5 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=bbe95013" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=c64b94d8"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/8.tuv-x_standard_configurations';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://ncar.github.io/musica/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.14.5';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">MUSICA 0.14.5 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    MUSICA API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../citing/index.html">
    Citing MUSICA
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NCAR/musica" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    MUSICA API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../citing/index.html">
    Citing MUSICA
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NCAR/musica" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">TUV-x:...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="TUV-x:-Standard-Configurations">
<h1>TUV-x: Standard Configurations<a class="headerlink" href="#TUV-x:-Standard-Configurations" title="Link to this heading">#</a></h1>
<p>The <a class="reference external" href="https://github.com/ncar/tuv-x">TUV-x photolysis calculator</a> is available as part of the MUSICA library. TUV-x can be used to calculate photolysis rate constants for a given set of conditions. It can also be used to calculate exposure metrics (“dose rates” in TUV-x lingo) based on the calculated radiation field.</p>
<p>TUV-x can be configured for any number of photolysis and dose rate calculations. We also provide two standard configurations in the MUSICA Python package:</p>
<ul class="simple">
<li><p>v5.4: A TUV-x configuration that corresponds to the original <a class="reference external" href="https://www2.acom.ucar.edu/modeling/tuv-download">TUV 5.4 model</a></p></li>
<li><p>vTS1/TSMLT: A TUV-x configuration for use with the MOZART TS1 and TSMLT chemical mechanisms</p></li>
</ul>
<section id="\text{O}_3-Photolysis-Comparison">
<h2><span class="math notranslate nohighlight">\(\text{O}_3\)</span> Photolysis Comparison<a class="headerlink" href="#\text{O}_3-Photolysis-Comparison" title="Link to this heading">#</a></h2>
<p>To get started, we’ll use the two standard TUV-x configurations to calculate the rate constants for O3 photolysis. We include rate constants for both <span class="math notranslate nohighlight">\(\text{O}_3\)</span> photolysis branches (forming <span class="math notranslate nohighlight">\(\text{O(1D)}\)</span> or <span class="math notranslate nohighlight">\(\text{O(3P)}\)</span>).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">musica.tuvx</span><span class="w"> </span><span class="kn">import</span> <span class="n">v54</span><span class="p">,</span> <span class="n">vTS1</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">musica.tuvx</span><span class="w"> </span><span class="kn">import</span> <span class="n">TUVX</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>

<span class="n">v54_calculator</span><span class="p">:</span> <span class="n">TUVX</span> <span class="o">=</span> <span class="n">v54</span><span class="o">.</span><span class="n">get_tuvx_calculator</span><span class="p">()</span>
<span class="n">vTS1_calculator</span><span class="p">:</span> <span class="n">TUVX</span> <span class="o">=</span> <span class="n">vTS1</span><span class="o">.</span><span class="n">get_tuvx_calculator</span><span class="p">()</span>

<span class="n">v54_results</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">=</span> <span class="n">v54_calculator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sza</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">earth_sun_distance</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">vTS1_results</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">=</span> <span class="n">vTS1_calculator</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sza</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">earth_sun_distance</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<p>Here, we first load the required dependencies. TUV-x returns results as XArray Datasets, so we also import XArray.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">get_tuvx_calculator()</span></code> functions return fully configured TUV-x instances, loaded with specific rate constant and dose rate algorithms, along with a set of standard environmental conditions (we’ll look at these more in a later section). The v5.4 and vTS1/TSMLT configurations include the same set of standard environmental conditions to facilitate comparisons. The environmental conditions and results from TUV-x are for a vertical atmosphere column. The standard conditions use a column with
120 layers of 1-km height per layer. TUV-x can be configured to work with columns with any number of layers.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">TUVX::run()</span></code> function calculates photolysis rate constants and dose rates by first solving the radiation field for the column, and then applying the configured photolysis and dose rate algorithms to the calculated radiation field. The two arguments to the <code class="docutils literal notranslate"><span class="pre">TUVX::run()</span></code> function set the solar zenith angle (<code class="docutils literal notranslate"><span class="pre">sza</span></code>) [radians] and the Earth–Sun Distance(<code class="docutils literal notranslate"><span class="pre">earth_sun_distance</span></code>) [AU].</p>
<p>Now, let’s compare the results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the labels for the O3 reactions are different in the two configurations</span>
<span class="n">jo3_o1d_v54_label</span> <span class="o">=</span> <span class="s2">&quot;O3+hv-&gt;O2+O(1D)&quot;</span>
<span class="n">jo3_o3p_v54_label</span> <span class="o">=</span> <span class="s2">&quot;O3+hv-&gt;O2+O(3P)&quot;</span>
<span class="n">jo3_o1d_vTS1_label</span> <span class="o">=</span> <span class="s2">&quot;jo3_a&quot;</span>
<span class="n">jo3_o3p_vTS1_label</span> <span class="o">=</span> <span class="s2">&quot;jo3_b&quot;</span>

<span class="c1"># get the height and O3 profiles for both sets of results</span>
<span class="n">height_v54</span> <span class="o">=</span> <span class="n">v54_results</span><span class="p">[</span><span class="s2">&quot;vertical_edge&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">jo3_o1d_v54</span> <span class="o">=</span> <span class="n">v54_results</span><span class="p">[</span><span class="s2">&quot;photolysis_rate_constants&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">reaction</span><span class="o">=</span><span class="n">jo3_o1d_v54_label</span><span class="p">)</span>
<span class="n">jo3_o3p_v54</span> <span class="o">=</span> <span class="n">v54_results</span><span class="p">[</span><span class="s2">&quot;photolysis_rate_constants&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">reaction</span><span class="o">=</span><span class="n">jo3_o3p_v54_label</span><span class="p">)</span>
<span class="n">height_vTS1</span> <span class="o">=</span> <span class="n">vTS1_results</span><span class="p">[</span><span class="s2">&quot;vertical_edge&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">jo3_o1d_vTS1</span> <span class="o">=</span> <span class="n">vTS1_results</span><span class="p">[</span><span class="s2">&quot;photolysis_rate_constants&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">reaction</span><span class="o">=</span><span class="n">jo3_o1d_vTS1_label</span><span class="p">)</span>
<span class="n">jo3_o3p_vTS1</span> <span class="o">=</span> <span class="n">vTS1_results</span><span class="p">[</span><span class="s2">&quot;photolysis_rate_constants&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">reaction</span><span class="o">=</span><span class="n">jo3_o3p_vTS1_label</span><span class="p">)</span>

<span class="c1"># plot the comparison</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jo3_o1d_v54</span><span class="p">,</span> <span class="n">height_v54</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TUV-x v5.4 O3-&gt;O(1D)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jo3_o3p_v54</span><span class="p">,</span> <span class="n">height_v54</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TUV-x v5.4 O3-&gt;O(3P)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jo3_o1d_vTS1</span><span class="p">,</span> <span class="n">height_vTS1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TUV-x TS1/TSMLT O3-&gt;O(1D)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jo3_o3p_vTS1</span><span class="p">,</span> <span class="n">height_vTS1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TUV-x TS1/TSMLT O3-&gt;O(3P)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Photolysis Rate Constant (s$^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Height (km)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;O3 Photolysis Rate Constants from TUV-x Configurations&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># plot the differences</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jo3_o1d_v54</span> <span class="o">-</span> <span class="n">jo3_o1d_vTS1</span><span class="p">,</span> <span class="n">height_v54</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Difference in O3-&gt;O(1D)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jo3_o3p_v54</span> <span class="o">-</span> <span class="n">jo3_o3p_vTS1</span><span class="p">,</span> <span class="n">height_v54</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Difference in O3-&gt;O(3P)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Photolysis Rate Constant Difference (s$^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Height (km)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Differences in O3 Photolysis Rate Constants between TUV-x Configurations&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_8.tuv-x_standard_configurations_3_0.png" src="../_images/tutorials_8.tuv-x_standard_configurations_3_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_8.tuv-x_standard_configurations_3_1.png" src="../_images/tutorials_8.tuv-x_standard_configurations_3_1.png" />
</div>
</div>
<p>The differences between results for the two configurations are relatively small, and in fact both the v5.4 and vTS1/TSMLT configurations use the same configuration for <span class="math notranslate nohighlight">\(\text{O}_3\)</span> photolysis:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O3+hv-&gt;O2+O(1D)&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;cross section&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;netcdf files&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;file path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data/cross_sections/O3_1.nc&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;file path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data/cross_sections/O3_2.nc&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;file path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data/cross_sections/O3_3.nc&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;file path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data/cross_sections/O3_4.nc&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O3&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;__output&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">   </span><span class="nt">&quot;quantum yield&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O3+hv-&gt;O2+O(1D)&quot;</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">},</span>
<span class="p">{</span>
<span class="w">   </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O3+hv-&gt;O2+O(3P)&quot;</span><span class="p">,</span>
<span class="w">   </span><span class="nt">&quot;cross section&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;netcdf files&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;file path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data/cross_sections/O3_1.nc&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;file path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data/cross_sections/O3_2.nc&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;file path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data/cross_sections/O3_3.nc&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;file path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data/cross_sections/O3_4.nc&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">],</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O3&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;__output&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">   </span><span class="nt">&quot;quantum yield&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;O3+hv-&gt;O2+O(3P)&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;__output&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">   </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The small differences we do see can be attributed to the differences in the 156- and 102-bin wavelength grids of the v5.4 and vTS1/TSMLT configurations, respectively. Solving the radiation field on differently shaped wavelength grids is expected to lead to differences in the results.</p>
<p>Now, let’s look at results for a photolysis rate constant that is configured differently in v5.4 and vTS1/TSMLT, <span class="math notranslate nohighlight">\(\text{N}_2\text{O}_5\)</span> photolysis:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the labels for the N2O5 reactions are difference in the two configurations</span>
<span class="n">jn2o5_v54_label</span> <span class="o">=</span> <span class="s2">&quot;N2O5+hv-&gt;NO2+NO3&quot;</span>
<span class="n">jn2o5a_vTS1_label</span> <span class="o">=</span> <span class="s2">&quot;jn2o5_a&quot;</span> <span class="c1"># N2O5 + hv -&gt; NO2 + NO3</span>
<span class="n">jn2o5b_vTS1_label</span> <span class="o">=</span> <span class="s2">&quot;jn2o5_b&quot;</span> <span class="c1"># N2O5 + hv -&gt; NO + O + NO3</span>

<span class="c1"># get the height and O3 profiles for both sets of results</span>
<span class="n">height_v54</span> <span class="o">=</span> <span class="n">v54_results</span><span class="p">[</span><span class="s2">&quot;vertical_edge&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">jn2o5_v54</span> <span class="o">=</span> <span class="n">v54_results</span><span class="p">[</span><span class="s2">&quot;photolysis_rate_constants&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">reaction</span><span class="o">=</span><span class="n">jn2o5_v54_label</span><span class="p">)</span>
<span class="n">height_vTS1</span> <span class="o">=</span> <span class="n">vTS1_results</span><span class="p">[</span><span class="s2">&quot;vertical_edge&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">jn2o5a_vTS1</span> <span class="o">=</span> <span class="n">vTS1_results</span><span class="p">[</span><span class="s2">&quot;photolysis_rate_constants&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">reaction</span><span class="o">=</span><span class="n">jn2o5a_vTS1_label</span><span class="p">)</span>
<span class="n">jn2o5b_vTS1</span> <span class="o">=</span> <span class="n">vTS1_results</span><span class="p">[</span><span class="s2">&quot;photolysis_rate_constants&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">reaction</span><span class="o">=</span><span class="n">jn2o5b_vTS1_label</span><span class="p">)</span>

<span class="c1"># plot the comparison</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jn2o5_v54</span><span class="p">,</span> <span class="n">height_v54</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TUV-x v5.4 N2O5-&gt;NO2+NO3&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jn2o5a_vTS1</span><span class="p">,</span> <span class="n">height_vTS1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TUV-x TS1/TSMLT N2O5-&gt;NO2+NO3&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jn2o5b_vTS1</span><span class="p">,</span> <span class="n">height_vTS1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TUV-x TS1/TSMLT N2O5-&gt;NO+O+NO3&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Photolysis Rate Constant (s$^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Height (km)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;N2O5 Photolysis Rate Constants from TUV-x Configurations&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># plot the difference between the single v5.4 rate constant and the sum of the two TS1/TSMLT rate constants</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">jn2o5_v54</span> <span class="o">-</span> <span class="p">(</span><span class="n">jn2o5a_vTS1</span> <span class="o">+</span> <span class="n">jn2o5b_vTS1</span><span class="p">),</span> <span class="n">height_v54</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Difference in N2O5 Photolysis Rate Constants&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Photolysis Rate Constant Difference (s$^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Height (km)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Differences in net N2O5 Photolysis Rate Constants between TUV-x Configurations&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_8.tuv-x_standard_configurations_5_0.png" src="../_images/tutorials_8.tuv-x_standard_configurations_5_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7f3768df6a50&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_8.tuv-x_standard_configurations_5_2.png" src="../_images/tutorials_8.tuv-x_standard_configurations_5_2.png" />
</div>
</div>
<p>Note that the v5.4 configuration only includes a single pathway for <span class="math notranslate nohighlight">\(\text{N}_2\text{O}_5\)</span> photolysis, whereas the vTS1/TSMLT includes two. The rate constant for the single pathway in v5.4 is approximately equal to the combination of the two pathways in vTS1/TSMLT.</p>
</section>
<section id="Dose-Rates">
<h2>Dose Rates<a class="headerlink" href="#Dose-Rates" title="Link to this heading">#</a></h2>
<p>Let’s plot a couple dose rate outputs, as well. The vTS1/TSMLT configuration doesn’t include dose rates, as it’s primarily designed for use with the MOZART TS1/TSMLT chemical mechanisms, so we’ll just plot rates from the v5.4 configuration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dose rate labels</span>
<span class="n">uva_label</span> <span class="o">=</span> <span class="s2">&quot;UV-A, 315-400 nm&quot;</span>
<span class="n">uvb_label</span> <span class="o">=</span> <span class="s2">&quot;UV-B, 280-315 nm&quot;</span>

<span class="c1"># dose rates from the v5.4 configuration</span>
<span class="n">uva_v54</span> <span class="o">=</span> <span class="n">v54_results</span><span class="p">[</span><span class="s2">&quot;dose_rates&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dose_rate</span><span class="o">=</span><span class="n">uva_label</span><span class="p">)</span>
<span class="n">uvb_v54</span> <span class="o">=</span> <span class="n">v54_results</span><span class="p">[</span><span class="s2">&quot;dose_rates&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">dose_rate</span><span class="o">=</span><span class="n">uvb_label</span><span class="p">)</span>

<span class="c1"># plot the dose rate profiles</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">uva_v54</span><span class="p">,</span> <span class="n">height_v54</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TUV-x v5.4 UV-A (315-400 nm) Dose Rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">uvb_v54</span><span class="p">,</span> <span class="n">height_v54</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;TUV-x v5.4 UV-B (280-315 nm) Dose Rate&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Dose Rate (W/m$^2$-nm)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Height (km)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;UV Dose Rates from TUV-x v5.4 Configuration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_8.tuv-x_standard_configurations_8_0.png" src="../_images/tutorials_8.tuv-x_standard_configurations_8_0.png" />
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#\text{O}_3-Photolysis-Comparison"><span class="math notranslate nohighlight">\(\text{O}_3\)</span> Photolysis Comparison</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Dose-Rates">Dose Rates</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/tutorials/8.tuv-x_standard_configurations.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024-2026, NSF NCAR.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>