
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Aluminum &#8212; MUSICA 0.14.3 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=bbe95013" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=a9ba800c"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/7. carma';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://ncar.github.io/musica/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.14.3';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MUSICA API" href="../api/index.html" />
    <link rel="prev" title="Enabling Your GPU for a Solver in MUSICA" href="6.%20gpu_solver.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">MUSICA 0.14.3 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    MUSICA API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../citing/index.html">
    Citing MUSICA
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NCAR/musica" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    MUSICA API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../citing/index.html">
    Citing MUSICA
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NCAR/musica" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter0.html">Chapter 0</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter1.html">Chapter 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter2.html">Chapter 2</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.%20multiple_grid_cells.html">Multiple Grid Cells in MUSICA</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.%20hypercube.html">Latin Hypercube Sampling in MUSICA</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.%20user_defined_reactions.html">User Defined Reactions in MUSICA</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.%20local_parallelization.html">Parallelizing Multiple Grid Cells Locally</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.%20hpc_parallelization.html">Parallelizing Multiple Grid Cells on a High-Performance Computing Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.%20gpu_solver.html">Enabling Your GPU for a Solver in MUSICA</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Aluminum</a></li>


</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="tutorials.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Aluminum</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>The Community Aerosol and Radiation Model for Atmospheres, <a class="reference external" href="https://github.com/ESCOMP/CARMA">CARMA</a>, can be configured and run through musica. This tutorial walks through creating two small carma test..</p>
<p>First, we need to import our packages</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">musica</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ussa1976</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">musica.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">GAS_CONSTANT</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">musica.mechanism_configuration</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</pre></div>
</div>
</div>
<section id="Aluminum">
<h1>Aluminum<a class="headerlink" href="#Aluminum" title="Link to this heading">#</a></h1>
<p>The first test is a coagulation test for aluminum in 5 bins. Please note that all input data going into the musica carma package should be in SI units, so meters instead of centimeters, pascal instead of hectapascals, etc. Anytime CARMA would be expecting a different unit, the musica package will automatically make that conversion when configuring carma.</p>
<p>First up, we create the groups and elements, and create our carma paramters class. This is then used to make an instance of CARMA.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAGroupConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;aluminum&quot;</span><span class="p">,</span>
    <span class="n">shortname</span><span class="o">=</span><span class="s2">&quot;PRALUM&quot;</span><span class="p">,</span>
    <span class="n">rmrat</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
    <span class="n">rmin</span><span class="o">=</span><span class="mf">21.5e-6</span><span class="p">,</span>
    <span class="n">rmon</span><span class="o">=</span><span class="mf">21.5e-6</span><span class="p">,</span>
    <span class="n">ishape</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleShape</span><span class="o">.</span><span class="n">SPHERE</span><span class="p">,</span>
    <span class="n">eshape</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">mie_calculation_algorithm</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">MieCalculationAlgorithm</span><span class="o">.</span><span class="n">TOON_1981</span><span class="p">,</span>
    <span class="n">is_ice</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">is_fractal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">do_wetdep</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">do_drydep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">do_vtran</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">solfac</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">scavcoef</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">df</span><span class="o">=</span><span class="p">[</span><span class="mf">1.6</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># 5 bins with fractal dimension 1.6</span>
    <span class="n">falpha</span><span class="o">=</span><span class="mf">1.0</span>
<span class="p">)</span>

<span class="c1"># Create aluminum element</span>
<span class="n">element</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAElementConfig</span><span class="p">(</span>
    <span class="n">igroup</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">isolute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Aluminum&quot;</span><span class="p">,</span>
    <span class="n">shortname</span><span class="o">=</span><span class="s2">&quot;ALUM&quot;</span><span class="p">,</span>
    <span class="n">itype</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleType</span><span class="o">.</span><span class="n">INVOLATILE</span><span class="p">,</span>
    <span class="n">icomposition</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleComposition</span><span class="o">.</span><span class="n">ALUMINUM</span><span class="p">,</span>
    <span class="n">rho</span><span class="o">=</span><span class="mf">0.00395</span><span class="p">,</span>  <span class="c1"># kg/m3</span>
    <span class="n">arat</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># 5 bins with area ratio 1.0</span>
    <span class="n">kappa</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Create coagulation</span>
<span class="n">coagulation</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMACoagulationConfig</span><span class="p">(</span>
    <span class="n">igroup1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">igroup2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">igroup3</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleCollectionAlgorithm</span><span class="o">.</span><span class="n">FUCHS</span><span class="p">)</span>

<span class="n">params</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAParameters</span><span class="p">(</span>
    <span class="n">nbin</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">nz</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">dtime</span><span class="o">=</span><span class="mf">1800.0</span><span class="p">,</span>
    <span class="n">groups</span><span class="o">=</span><span class="p">[</span><span class="n">group</span><span class="p">],</span>
    <span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="n">element</span><span class="p">],</span>
    <span class="n">coagulations</span><span class="o">=</span><span class="p">[</span><span class="n">coagulation</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">FIVE_DAYS_IN_SECONDS</span> <span class="o">=</span> <span class="mi">432000</span>
<span class="n">params</span><span class="o">.</span><span class="n">nstep</span> <span class="o">=</span> <span class="n">FIVE_DAYS_IN_SECONDS</span> <span class="o">//</span> <span class="n">params</span><span class="o">.</span><span class="n">dtime</span>
<span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">do_vtran</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">carma</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMA</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next, we make some envionrmental data which we will use to initialize our state.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_levels</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">nz</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="mf">1000.0</span>
<span class="n">zmin</span> <span class="o">=</span> <span class="mf">16500.0</span>

<span class="n">vertical_center</span> <span class="o">=</span> <span class="n">zmin</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_levels</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">deltaz</span>
<span class="n">vertical_levels</span> <span class="o">=</span> <span class="n">zmin</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_levels</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">deltaz</span>

<span class="n">centered_variables</span> <span class="o">=</span> <span class="n">ussa1976</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">vertical_center</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;rho&quot;</span><span class="p">])</span>
<span class="n">edge_variables</span> <span class="o">=</span> <span class="n">ussa1976</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">vertical_levels</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">])</span>

<span class="n">temperature</span> <span class="o">=</span> <span class="n">centered_variables</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">values</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="n">centered_variables</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">values</span>
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">edge_variables</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">values</span>
<span class="n">density</span> <span class="o">=</span> <span class="n">centered_variables</span><span class="o">.</span><span class="n">rho</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<p>Finally, we will run the carma box model. While the model runs, we will also collect the data. At the end we will combine it all into one xarray dataset.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mmr_initial</span> <span class="o">=</span> <span class="mf">5e9</span> <span class="o">/</span> <span class="p">(</span><span class="n">deltaz</span> <span class="o">*</span> <span class="mf">2.57474699e14</span><span class="p">)</span> <span class="o">/</span> <span class="n">density</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">state</span> <span class="o">=</span> <span class="n">carma</span><span class="o">.</span><span class="n">create_state</span><span class="p">(</span>
    <span class="n">time_step</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">dtime</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
    <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span>
    <span class="n">pressure_levels</span><span class="o">=</span><span class="n">pressure_levels</span><span class="p">,</span>
    <span class="n">vertical_center</span><span class="o">=</span><span class="n">vertical_center</span><span class="p">,</span>
    <span class="n">vertical_levels</span><span class="o">=</span><span class="n">vertical_levels</span><span class="p">,</span>
    <span class="n">longitude</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">latitude</span><span class="o">=-</span><span class="mf">105.0</span><span class="p">,</span>
    <span class="n">coordinates</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CarmaCoordinates</span><span class="o">.</span><span class="n">CARTESIAN</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">nbin</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">elements</span><span class="p">)):</span>
        <span class="n">state</span><span class="o">.</span><span class="n">set_bin</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mmr_initial</span><span class="p">)</span>

<span class="n">bin_data</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get_bins</span><span class="p">()</span>
<span class="n">bin_data</span> <span class="o">=</span> <span class="n">bin_data</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get_environmental_values</span><span class="p">()</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="n">time_array</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># Start with time 0</span>

<span class="c1"># Run the simulation for the specified number of steps</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">nstep</span><span class="p">)):</span>
    <span class="n">state</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">bin_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">bin_data</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">get_bins</span><span class="p">()</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">step</span> <span class="o">*</span> <span class="n">params</span><span class="o">.</span><span class="n">dtime</span><span class="p">]})],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">env</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">get_environmental_values</span><span class="p">()</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">step</span> <span class="o">*</span> <span class="n">params</span><span class="o">.</span><span class="n">dtime</span><span class="p">]})],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">time_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span> <span class="o">*</span> <span class="n">params</span><span class="o">.</span><span class="n">dtime</span><span class="p">)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">bin_data</span><span class="p">,</span> <span class="n">env</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 154kB
Dimensions:                     (time: 240, bin: 5, element: 1,
                                 vertical_center: 1, vertical_level: 2)
Coordinates:
  * time                        (time) float64 2kB 0.0 1.8e+03 ... 4.302e+05
  * bin                         (bin) int64 40B 1 2 3 4 5
  * element                     (element) int64 8B 1
  * vertical_center             (vertical_center) float64 8B 1.7e+04
  * vertical_level              (vertical_level) float64 16B 1.65e+04 1.75e+04
Data variables: (12/18)
    mass_mixing_ratio           (time, bin, element, vertical_center) float64 10kB ...
    number_mixing_ratio         (time, bin, element, vertical_center) float64 10kB ...
    number_density              (time, bin, element, vertical_center) float64 10kB ...
    nucleation_rate             (time, bin, element, vertical_center) float64 10kB ...
    wet_particle_radius         (time, bin, element, vertical_center) float64 10kB ...
    wet_particle_density        (time, bin, element, vertical_center) float64 10kB ...
    ...                          ...
    sedimentation_flux          (time, bin, element) float64 10kB 0.0 ... 0.0
    deposition_velocity         (time, bin, element) float64 10kB -9.99 ... -...
    temperature                 (time, vertical_center) float64 2kB 216.6 ......
    pressure                    (time, vertical_center) float64 2kB 8.85e+03 ...
    air_density                 (time, vertical_center) float64 2kB 0.1417 .....
    latent_heat                 (time, vertical_center) object 2kB None ... None</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-9e7ce58d-1558-41da-bc0b-81dd71aef5ef' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9e7ce58d-1558-41da-bc0b-81dd71aef5ef' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 240</li><li><span class='xr-has-index'>bin</span>: 5</li><li><span class='xr-has-index'>element</span>: 1</li><li><span class='xr-has-index'>vertical_center</span>: 1</li><li><span class='xr-has-index'>vertical_level</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d6551334-b643-40cc-a286-3ba99c4ac500' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d6551334-b643-40cc-a286-3ba99c4ac500' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.8e+03 ... 4.284e+05 4.302e+05</div><input id='attrs-f29d4ccd-9008-41ba-a396-68c42f478b0a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f29d4ccd-9008-41ba-a396-68c42f478b0a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d4015c32-30df-4342-99e7-d6957ef77df5' class='xr-var-data-in' type='checkbox'><label for='data-d4015c32-30df-4342-99e7-d6957ef77df5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([     0.,   1800.,   3600., ..., 426600., 428400., 430200.], shape=(240,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>bin</span></div><div class='xr-var-dims'>(bin)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5</div><input id='attrs-3e61d5b4-c529-424c-8c65-52ea6a1c106b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3e61d5b4-c529-424c-8c65-52ea6a1c106b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fb8667f2-a3d7-48db-a270-aa4fe95c350b' class='xr-var-data-in' type='checkbox'><label for='data-fb8667f2-a3d7-48db-a270-aa4fe95c350b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 2, 3, 4, 5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>element</span></div><div class='xr-var-dims'>(element)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-6535a559-6ab2-4056-ad9a-8093dd43cbf4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6535a559-6ab2-4056-ad9a-8093dd43cbf4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d2e0afa4-fade-4da3-9fc3-1b5c51aa65a1' class='xr-var-data-in' type='checkbox'><label for='data-d2e0afa4-fade-4da3-9fc3-1b5c51aa65a1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>vertical_center</span></div><div class='xr-var-dims'>(vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.7e+04</div><input id='attrs-78882ea0-401a-4fcc-98af-e78af140959e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-78882ea0-401a-4fcc-98af-e78af140959e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b9fc96e8-1b19-403e-bf9a-207683ea567a' class='xr-var-data-in' type='checkbox'><label for='data-b9fc96e8-1b19-403e-bf9a-207683ea567a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([17000.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>vertical_level</span></div><div class='xr-var-dims'>(vertical_level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.65e+04 1.75e+04</div><input id='attrs-89714c99-218e-45de-8530-6f7dd49f6a98' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-89714c99-218e-45de-8530-6f7dd49f6a98' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-39e1dcfb-dff8-442c-9aa4-651db43e413b' class='xr-var-data-in' type='checkbox'><label for='data-39e1dcfb-dff8-442c-9aa4-651db43e413b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([16500., 17500.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b209a091-ba52-4906-a1c1-524e74d76278' class='xr-section-summary-in' type='checkbox'  ><label for='section-b209a091-ba52-4906-a1c1-524e74d76278' class='xr-section-summary' >Data variables: <span>(18)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>mass_mixing_ratio</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.365e-07 1.365e-07 ... 1.453e-07</div><input id='attrs-df90c639-b9d6-42b9-a343-0acfaabb6985' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-df90c639-b9d6-42b9-a343-0acfaabb6985' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bd7ff2a6-c6c9-4f35-b771-2e093cb50476' class='xr-var-data-in' type='checkbox'><label for='data-bd7ff2a6-c6c9-4f35-b771-2e093cb50476' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg kg-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle mass mixing ratio</dd></dl></div><div class='xr-var-data'><pre>array([[[[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]]],


       [[[1.36427335e-07]],

        [[1.36453356e-07]],

        [[1.36471940e-07]],

        [[1.36477617e-07]],

        [[1.36503414e-07]]],
...
       [[[1.27520200e-07]],

        [[1.33176857e-07]],

        [[1.37461746e-07]],

        [[1.38929726e-07]],

        [[1.45245134e-07]]],


       [[[1.27484358e-07]],

        [[1.33162640e-07]],

        [[1.37464927e-07]],

        [[1.38939528e-07]],

        [[1.45282210e-07]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>number_mixing_ratio</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>8.299e+08 4.149e+08 ... 5.522e+07</div><input id='attrs-5ac95a33-3a51-49f0-84df-1183dd150474' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5ac95a33-3a51-49f0-84df-1183dd150474' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff7b88aa-a755-4749-aca9-8f01cc9212bb' class='xr-var-data-in' type='checkbox'><label for='data-ff7b88aa-a755-4749-aca9-8f01cc9212bb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle number mixing ratio</dd></dl></div><div class='xr-var-data'><pre>array([[[[8.29899894e+08]],

        [[4.14949947e+08]],

        [[2.07474974e+08]],

        [[1.03737487e+08]],

        [[5.18687434e+07]]],


       [[[8.29660306e+08]],

        [[4.14909273e+08]],

        [[2.07482891e+08]],

        [[1.03745761e+08]],

        [[5.18826855e+07]]],
...
       [[[7.75493033e+08]],

        [[4.04946530e+08]],

        [[2.08987726e+08]],

        [[1.05609773e+08]],

        [[5.52052684e+07]]],


       [[[7.75275068e+08]],

        [[4.04903301e+08]],

        [[2.08992562e+08]],

        [[1.05617224e+08]],

        [[5.52193600e+07]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>number_density</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.176e+08 5.88e+07 ... 7.825e+06</div><input id='attrs-d15110d6-1bfb-4069-8fd6-3b35d8b55a42' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d15110d6-1bfb-4069-8fd6-3b35d8b55a42' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7efec7a4-f46d-4bf5-b9dd-0c3d67403391' class='xr-var-data-in' type='checkbox'><label for='data-7efec7a4-f46d-4bf5-b9dd-0c3d67403391' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m-3</dd><dt><span>long_name :</span></dt><dd>Aerosol particle number density</dd></dl></div><div class='xr-var-data'><pre>array([[[[1.17595615e+08]],

        [[5.87978075e+07]],

        [[2.93989038e+07]],

        [[1.46994519e+07]],

        [[7.34972594e+06]]],


       [[[1.17561666e+08]],

        [[5.87920441e+07]],

        [[2.94000256e+07]],

        [[1.47006243e+07]],

        [[7.35170152e+06]]],
...
       [[[1.09886241e+08]],

        [[5.73803377e+07]],

        [[2.96132586e+07]],

        [[1.49647521e+07]],

        [[7.82250670e+06]]],


       [[[1.09855356e+08]],

        [[5.73742124e+07]],

        [[2.96139439e+07]],

        [[1.49658079e+07]],

        [[7.82450347e+06]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nucleation_rate</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.99e+08 -9.99e+08 ... -9.99e+08</div><input id='attrs-cfb3c44c-6613-46b4-b107-a2fb9e2e385a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cfb3c44c-6613-46b4-b107-a2fb9e2e385a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-94bc7e23-d6d5-4ae7-9b22-70c13d4fc2a2' class='xr-var-data-in' type='checkbox'><label for='data-94bc7e23-d6d5-4ae7-9b22-70c13d4fc2a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m-3 s-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle nucleation rate</dd></dl></div><div class='xr-var-data'><pre>array([[[[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]]],


       [[[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]]],
...
       [[[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]]],


       [[[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wet_particle_radius</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 4.3e-05 5.418e-05</div><input id='attrs-d9782e38-f744-483b-bc2f-5220dd1ed7a5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d9782e38-f744-483b-bc2f-5220dd1ed7a5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3b27bdbe-b1e7-46b1-a354-4ce9bfd51ee1' class='xr-var-data-in' type='checkbox'><label for='data-3b27bdbe-b1e7-46b1-a354-4ce9bfd51ee1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Wet aerosol particle radius</dd></dl></div><div class='xr-var-data'><pre>array([[[[0.00000000e+00]],

        [[0.00000000e+00]],

        [[0.00000000e+00]],

        [[0.00000000e+00]],

        [[0.00000000e+00]]],


       [[[2.14999995e-05]],

        [[2.70883020e-05]],

        [[3.41291219e-05]],

        [[4.29999990e-05]],

        [[5.41766039e-05]]],
...
       [[[2.14999995e-05]],

        [[2.70883020e-05]],

        [[3.41291219e-05]],

        [[4.29999990e-05]],

        [[5.41766039e-05]]],


       [[[2.14999995e-05]],

        [[2.70883020e-05]],

        [[3.41291219e-05]],

        [[4.29999990e-05]],

        [[5.41766039e-05]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wet_particle_density</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 0.00395 0.00395</div><input id='attrs-a5545aeb-2f1f-4677-8518-c197c0fe501e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a5545aeb-2f1f-4677-8518-c197c0fe501e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c68fc34d-20cf-4665-b1c2-aa6faf561f77' class='xr-var-data-in' type='checkbox'><label for='data-c68fc34d-20cf-4665-b1c2-aa6faf561f77' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-3</dd><dt><span>long_name :</span></dt><dd>Wet aerosol particle density</dd></dl></div><div class='xr-var-data'><pre>array([[[[0.     ]],

        [[0.     ]],

        [[0.     ]],

        [[0.     ]],

        [[0.     ]]],


       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]],
...
       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]],


       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dry_particle_density</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 0.00395 0.00395</div><input id='attrs-abdc0197-532d-4aa7-bddd-0c6134c9eebc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-abdc0197-532d-4aa7-bddd-0c6134c9eebc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36f99926-0b78-41c3-a29b-aa24f8d40426' class='xr-var-data-in' type='checkbox'><label for='data-36f99926-0b78-41c3-a29b-aa24f8d40426' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-3</dd><dt><span>long_name :</span></dt><dd>Dry aerosol particle density</dd></dl></div><div class='xr-var-data'><pre>array([[[[0.     ]],

        [[0.     ]],

        [[0.     ]],

        [[0.     ]],

        [[0.     ]]],


       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]],
...
       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]],


       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>delta_particle_temperature</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-999.0 -999.0 ... -999.0 -999.0</div><input id='attrs-d9df7a01-2af1-4ec6-9923-02dc7753ea68' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d9df7a01-2af1-4ec6-9923-02dc7753ea68' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3347ae4a-97f9-4336-81f6-4e75813e33d3' class='xr-var-data-in' type='checkbox'><label for='data-3347ae4a-97f9-4336-81f6-4e75813e33d3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Aerosol particle temperature change</dd></dl></div><div class='xr-var-data'><pre>array([[[[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]]],


       [[[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]]],
...
       [[[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]]],


       [[[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>kappa</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 ... -1.798e+308 -1.798e+308</div><input id='attrs-e5b22124-64c0-4245-ae6c-33d91712a1c1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e5b22124-64c0-4245-ae6c-33d91712a1c1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1dbec4e-7629-47b1-a517-03414fc65a0f' class='xr-var-data-in' type='checkbox'><label for='data-e1dbec4e-7629-47b1-a517-03414fc65a0f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>-</dd><dt><span>long_name :</span></dt><dd>Aerosol particle hygroscopicity parameter</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 0.00000000e+000]],

        [[ 0.00000000e+000]],

        [[ 0.00000000e+000]],

        [[ 0.00000000e+000]],

        [[ 0.00000000e+000]]],


       [[[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]]],
...
       [[[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]]],


       [[[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>total_mass_mixing_ratio</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.365e-07 1.365e-07 ... 1.453e-07</div><input id='attrs-ff5e885e-f254-490f-8830-c8904d1c5c5c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ff5e885e-f254-490f-8830-c8904d1c5c5c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bcd86151-d4a5-4234-8def-4696cbb1193f' class='xr-var-data-in' type='checkbox'><label for='data-bcd86151-d4a5-4234-8def-4696cbb1193f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-3</dd><dt><span>long_name :</span></dt><dd>Total aerosol particle mass mixing ratio</dd></dl></div><div class='xr-var-data'><pre>array([[[[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]]],


       [[[1.36427335e-07]],

        [[1.36453356e-07]],

        [[1.36471940e-07]],

        [[1.36477617e-07]],

        [[1.36503414e-07]]],
...
       [[[1.27520200e-07]],

        [[1.33176857e-07]],

        [[1.37461746e-07]],

        [[1.38929726e-07]],

        [[1.45245134e-07]]],


       [[[1.27484358e-07]],

        [[1.33162640e-07]],

        [[1.37464927e-07]],

        [[1.38939528e-07]],

        [[1.45282210e-07]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fall_velocity</span></div><div class='xr-var-dims'>(time, bin, element, vertical_level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.99 -9.99 -9.99 ... -9.99 -9.99</div><input id='attrs-fad7532c-2448-413d-b76a-b0b8f45f3cf6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fad7532c-2448-413d-b76a-b0b8f45f3cf6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a5b3c78-f591-485c-acfa-5b3a1f083b98' class='xr-var-data-in' type='checkbox'><label for='data-6a5b3c78-f591-485c-acfa-5b3a1f083b98' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle fall velocity</dd></dl></div><div class='xr-var-data'><pre>array([[[[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]]],


       [[[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]]],
...
       [[[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]]],


       [[[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]]]], shape=(240, 5, 1, 2))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>particle_mass_on_surface</span></div><div class='xr-var-dims'>(time, bin, element)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-6523a4dc-ae2e-461e-a332-4e9ce09d7126' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6523a4dc-ae2e-461e-a332-4e9ce09d7126' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7b445cf1-7ba4-4ab8-a391-48d578233977' class='xr-var-data-in' type='checkbox'><label for='data-7b445cf1-7ba4-4ab8-a391-48d578233977' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-2</dd><dt><span>long_name :</span></dt><dd>Aerosol particle mass on surface</dd></dl></div><div class='xr-var-data'><pre>array([[[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       ...,

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]]], shape=(240, 5, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sedimentation_flux</span></div><div class='xr-var-dims'>(time, bin, element)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-84b030ab-b915-4955-9d71-8629b8195577' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-84b030ab-b915-4955-9d71-8629b8195577' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4eb087e0-79a9-4fc5-bd39-1c8e3a9c2519' class='xr-var-data-in' type='checkbox'><label for='data-4eb087e0-79a9-4fc5-bd39-1c8e3a9c2519' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-2 s-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle sedimentation flux</dd></dl></div><div class='xr-var-data'><pre>array([[[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       ...,

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]]], shape=(240, 5, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>deposition_velocity</span></div><div class='xr-var-dims'>(time, bin, element)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.99 -9.99 -9.99 ... -9.99 -9.99</div><input id='attrs-6708e0f5-8bf0-406c-836a-13dbcc6d30e4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6708e0f5-8bf0-406c-836a-13dbcc6d30e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c4c87f2-0166-4d56-9062-46e426d42751' class='xr-var-data-in' type='checkbox'><label for='data-9c4c87f2-0166-4d56-9062-46e426d42751' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle deposition velocity</dd></dl></div><div class='xr-var-data'><pre>array([[[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]],

       [[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]],

       [[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]],

       ...,

       [[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]],

       [[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]],

       [[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]]], shape=(240, 5, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temperature</span></div><div class='xr-var-dims'>(time, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>216.6 216.6 216.6 ... 216.6 216.6</div><input id='attrs-b8b93918-9160-4c08-94d9-40e42868ca12' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b8b93918-9160-4c08-94d9-40e42868ca12' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85be0c47-e7d8-4de1-ba82-63562694d77f' class='xr-var-data-in' type='checkbox'><label for='data-85be0c47-e7d8-4de1-ba82-63562694d77f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Temperature</dd></dl></div><div class='xr-var-data'><pre>array([[216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
...
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65],
       [216.65]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pressure</span></div><div class='xr-var-dims'>(time, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>8.85e+03 8.85e+03 ... 8.85e+03</div><input id='attrs-01505757-c9a6-456d-af9b-daf218c0cbdc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-01505757-c9a6-456d-af9b-daf218c0cbdc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e38b9e37-0b86-449a-97b9-eaada360bcde' class='xr-var-data-in' type='checkbox'><label for='data-e38b9e37-0b86-449a-97b9-eaada360bcde' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Pa</dd><dt><span>long_name :</span></dt><dd>Pressure</dd></dl></div><div class='xr-var-data'><pre>array([[8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
...
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538],
       [8849.7125538]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>air_density</span></div><div class='xr-var-dims'>(time, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.1417 0.1417 ... 0.1417 0.1417</div><input id='attrs-d4e4385e-c33c-453c-bd4b-453833b53490' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d4e4385e-c33c-453c-bd4b-453833b53490' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c0a823fb-6c79-4d0c-81b4-b8a4c19098c2' class='xr-var-data-in' type='checkbox'><label for='data-c0a823fb-6c79-4d0c-81b4-b8a4c19098c2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-3</dd><dt><span>long_name :</span></dt><dd>Air density</dd></dl></div><div class='xr-var-data'><pre>array([[0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
...
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855],
       [0.14169855]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latent_heat</span></div><div class='xr-var-dims'>(time, vertical_center)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>None None None ... None None None</div><input id='attrs-d690aab0-d28c-406d-9e77-3ee2cd79eb8b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d690aab0-d28c-406d-9e77-3ee2cd79eb8b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0bd08357-60b0-44b8-80c5-8d259756378c' class='xr-var-data-in' type='checkbox'><label for='data-0bd08357-60b0-44b8-80c5-8d259756378c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K s-1</dd><dt><span>long_name :</span></dt><dd>Latent heat release rate</dd></dl></div><div class='xr-var-data'><pre>array([[None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
...
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None],
       [None]], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-980cdabf-8f1c-4a74-b1f5-33d5c10011be' class='xr-section-summary-in' type='checkbox'  ><label for='section-980cdabf-8f1c-4a74-b1f5-33d5c10011be' class='xr-section-summary' >Indexes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b0b1c57f-09fc-4799-bb24-732047267cb6' class='xr-index-data-in' type='checkbox'/><label for='index-b0b1c57f-09fc-4799-bb24-732047267cb6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([     0.0,   1800.0,   3600.0,   5400.0,   7200.0,   9000.0,  10800.0,
        12600.0,  14400.0,  16200.0,
       ...
       414000.0, 415800.0, 417600.0, 419400.0, 421200.0, 423000.0, 424800.0,
       426600.0, 428400.0, 430200.0],
      dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=240))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>bin</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-cc01ec78-88e5-49ca-8930-958cce831df1' class='xr-index-data-in' type='checkbox'/><label for='index-cc01ec78-88e5-49ca-8930-958cce831df1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5], dtype=&#x27;int64&#x27;, name=&#x27;bin&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>element</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-54fc9b7f-2ae9-4b27-9888-934f2a28be0f' class='xr-index-data-in' type='checkbox'/><label for='index-54fc9b7f-2ae9-4b27-9888-934f2a28be0f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1], dtype=&#x27;int64&#x27;, name=&#x27;element&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>vertical_center</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-778b9f48-496c-4751-b613-eb58d990fea5' class='xr-index-data-in' type='checkbox'/><label for='index-778b9f48-496c-4751-b613-eb58d990fea5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([17000.0], dtype=&#x27;float64&#x27;, name=&#x27;vertical_center&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>vertical_level</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8e90b00a-0e93-4aa1-b8aa-88370d2adcf4' class='xr-index-data-in' type='checkbox'/><label for='index-8e90b00a-0e93-4aa1-b8aa-88370d2adcf4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([16500.0, 17500.0], dtype=&#x27;float64&#x27;, name=&#x27;vertical_level&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-fa3474df-81bf-4755-b4c4-7b8e158b916d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fa3474df-81bf-4755-b4c4-7b8e158b916d' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<p>Now we will make as serices of plots, but first we will transform the time from seconds to days to make the plotting labels nicer.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert from seconds to days</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span> <span class="o">/</span> <span class="mi">86400</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;mass_mixing_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;number_mixing_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;number_density&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wet_particle_radius&#39;</span><span class="p">,</span> <span class="s1">&#39;wet_particle_density&#39;</span><span class="p">,</span> <span class="s1">&#39;dry_particle_density&#39;</span><span class="p">,</span>
    <span class="s1">&#39;delta_particle_temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;fall_velocity&#39;</span><span class="p">,</span> <span class="s1">&#39;total_mass_mixing_ratio&#39;</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
    <span class="k">for</span> <span class="nb">bin</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">bin</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="nb">bin</span><span class="o">=</span><span class="nb">bin</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">element</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;vertical_level&#39;</span> <span class="ow">in</span> <span class="n">y</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">vertical_level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">vertical_center</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Bin </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span> <span class="o">*</span> <span class="mf">4.50</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;Bin </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">get_color</span><span class="p">())</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[:]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time [days]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">long_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Bin Properties&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_7._carma_11_0.png" src="../_images/tutorials_7._carma_11_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;mass_mixing_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;number_mixing_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;number_density&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wet_particle_radius&#39;</span><span class="p">,</span> <span class="s1">&#39;wet_particle_density&#39;</span><span class="p">,</span> <span class="s1">&#39;dry_particle_density&#39;</span><span class="p">,</span>
    <span class="s1">&#39;delta_particle_temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;fall_velocity&#39;</span><span class="p">,</span> <span class="s1">&#39;total_mass_mixing_ratio&#39;</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;bin&#39;</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[:]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time [days]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">long_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Bin Properties, summed&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_7._carma_12_0.png" src="../_images/tutorials_7._carma_12_0.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group_props</span><span class="p">,</span> <span class="n">group_config</span> <span class="o">=</span> <span class="n">carma</span><span class="o">.</span><span class="n">get_group_properties</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;bin_radius&#39;</span><span class="p">,</span> <span class="s1">&#39;bin_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;bin_volume&#39;</span><span class="p">,</span>
    <span class="s1">&#39;projected_area_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;radius_ratio&#39;</span><span class="p">,</span> <span class="s1">&#39;porosity_ratio&#39;</span><span class="p">,</span>
    <span class="s1">&#39;number_of_monomers_per_bin&#39;</span><span class="p">,</span> <span class="s1">&#39;bin_width_mass&#39;</span><span class="p">,</span> <span class="s1">&#39;bin_width&#39;</span>
<span class="p">]</span>

<span class="n">name_to_label</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;bin_radius&quot;</span><span class="p">:</span> <span class="s2">&quot;Bin radius&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_radius_lower_bound&quot;</span><span class="p">:</span> <span class="s2">&quot;Lower bound of bin radius&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_radius_upper_bound&quot;</span><span class="p">:</span> <span class="s2">&quot;Upper bound of bin radius&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_width&quot;</span><span class="p">:</span> <span class="s2">&quot;Bin width in radius space&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_mass&quot;</span><span class="p">:</span> <span class="s2">&quot;Bin mass&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_width_mass&quot;</span><span class="p">:</span> <span class="s2">&quot;Bin width in mass space&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_volume&quot;</span><span class="p">:</span> <span class="s2">&quot;Bin volume&quot;</span><span class="p">,</span>
    <span class="s2">&quot;projected_area_ratio&quot;</span><span class="p">:</span> <span class="s2">&quot;Projected area ratio&quot;</span><span class="p">,</span>
    <span class="s2">&quot;radius_ratio&quot;</span><span class="p">:</span> <span class="s2">&quot;Maximum dimension / radius of enclosing sphere&quot;</span><span class="p">,</span>
    <span class="s2">&quot;porosity_ratio&quot;</span><span class="p">:</span> <span class="s2">&quot;Scaled porosity radius / equiv. sphere&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extinction_coefficient&quot;</span><span class="p">:</span> <span class="s2">&quot;Extinction coefficient&quot;</span><span class="p">,</span>
    <span class="s2">&quot;single_scattering_albedo&quot;</span><span class="p">:</span> <span class="s2">&quot;Single scattering albedo&quot;</span><span class="p">,</span>
    <span class="s2">&quot;asymmetry_factor&quot;</span><span class="p">:</span> <span class="s2">&quot;Asymmetry factor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;particle_number_element_for_group&quot;</span><span class="p">:</span> <span class="s2">&quot;Index of element for particle number&quot;</span><span class="p">,</span>
    <span class="s2">&quot;number_of_core_mass_elements_for_group&quot;</span><span class="p">:</span> <span class="s2">&quot;Number of core mass elements&quot;</span><span class="p">,</span>
    <span class="s2">&quot;element_index_of_core_mass_elements&quot;</span><span class="p">:</span> <span class="s2">&quot;Indices of core mass elements&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_prognostic_bin&quot;</span><span class="p">:</span> <span class="s2">&quot;Last prognostic bin&quot;</span><span class="p">,</span>
    <span class="s2">&quot;number_of_monomers_per_bin&quot;</span><span class="p">:</span> <span class="s2">&quot;Number of monomers per bin&quot;</span>
<span class="p">}</span>
<span class="n">name_to_units</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;bin_radius&quot;</span><span class="p">:</span> <span class="s2">&quot;cm&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_radius_lower_bound&quot;</span><span class="p">:</span> <span class="s2">&quot;cm&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_radius_upper_bound&quot;</span><span class="p">:</span> <span class="s2">&quot;cm&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_width&quot;</span><span class="p">:</span> <span class="s2">&quot;cm&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_mass&quot;</span><span class="p">:</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_width_mass&quot;</span><span class="p">:</span> <span class="s2">&quot;g&quot;</span><span class="p">,</span>
    <span class="s2">&quot;bin_volume&quot;</span><span class="p">:</span> <span class="s2">&quot;cm3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;projected_area_ratio&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;radius_ratio&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;porosity_ratio&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extinction_coefficient&quot;</span><span class="p">:</span> <span class="s2">&quot;m-1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;single_scattering_albedo&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;asymmetry_factor&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;particle_number_element_for_group&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;number_of_core_mass_elements_for_group&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;element_index_of_core_mass_elements&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_prognostic_bin&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;number_of_monomers_per_bin&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
    <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">group_props</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[:]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Bins&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">name_to_units</span><span class="p">[</span><span class="n">var</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">name_to_units</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name_to_label</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Group Properties&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_7._carma_14_0.png" src="../_images/tutorials_7._carma_14_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;air_density&#39;</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
    <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[:]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [days]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="si">}</span><span class="s1">]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ds</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">long_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Environmental data&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_7._carma_15_0.png" src="../_images/tutorials_7._carma_15_0.png" />
</div>
</div>
</section>
<section id="Sulfate">
<h1>Sulfate<a class="headerlink" href="#Sulfate" title="Link to this heading">#</a></h1>
<p>This next model is more complex and tests sulfate.</p>
<p>First up we define the paramters to configure sulfate.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GRAVITY</span> <span class="o">=</span> <span class="mf">9.806</span>  <span class="c1"># Acceleration due to gravity in m/s^2</span>

<span class="c1"># Simplified constants for debugging</span>
<span class="n">NZ</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">NELEM</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">NBIN</span> <span class="o">=</span> <span class="mi">38</span>

<span class="n">dtime</span> <span class="o">=</span> <span class="mf">1800.0</span>  <span class="c1"># Time step in seconds</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="mf">10000.0</span>  <span class="c1"># Grid box height in meters</span>
<span class="n">nsteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">180000</span> <span class="o">/</span> <span class="n">dtime</span><span class="p">)</span>

<span class="c1"># Sulfate density</span>
<span class="n">rho_sulfate_kg_m3</span> <span class="o">=</span> <span class="mf">1923.0</span>  <span class="c1"># kg/m³</span>

<span class="c1"># Grid setup</span>
<span class="n">latitude</span> <span class="o">=</span> <span class="o">-</span><span class="mf">40.0</span>
<span class="n">longitude</span> <span class="o">=</span> <span class="o">-</span><span class="mf">105.0</span>
<span class="n">vertical_center</span> <span class="o">=</span> <span class="p">[</span><span class="mf">17000.0</span><span class="p">]</span>
<span class="n">vertical_levels</span> <span class="o">=</span> <span class="p">[</span><span class="n">vertical_center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">deltaz</span><span class="p">,</span> <span class="n">vertical_center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">deltaz</span><span class="p">]</span>

<span class="c1"># Standard atmosphere</span>
<span class="n">pressure_centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">9000.0</span><span class="p">])</span>
<span class="n">temperature_centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">250.0</span><span class="p">])</span>
<span class="c1"># this is directly from the original CARMA test, but it seems like there are some unit conversion issues</span>
<span class="n">air_mass_density_centers</span> <span class="o">=</span> <span class="n">pressure_centers</span> <span class="o">*</span> <span class="mf">10.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">8.31430e07</span> <span class="o">/</span> <span class="mf">28.966</span> <span class="o">*</span> <span class="n">temperature_centers</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0e-3</span> <span class="o">*</span> <span class="mf">1.0e6</span><span class="p">)</span>
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pressure_levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pressure_centers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> \
    <span class="p">(</span><span class="n">vertical_levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">vertical_center</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">air_mass_density_centers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">GRAVITY</span>
<span class="n">pressure_levels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">pressure_centers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> \
    <span class="p">(</span><span class="n">vertical_levels</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">vertical_center</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">air_mass_density_centers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">GRAVITY</span>

<span class="c1"># Initial mass mixing ratios</span>
<span class="n">mass_mixing_ratios</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0e-4</span><span class="p">],</span>
    <span class="s2">&quot;H2SO4&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1e-9</span> <span class="o">*</span> <span class="p">(</span><span class="mf">98.0</span> <span class="o">/</span> <span class="mf">29.0</span><span class="p">)],</span>
    <span class="s2">&quot;SULFATE&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NBIN</span><span class="p">)]]</span>
<span class="p">}</span>
<span class="n">satliq</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>
    <span class="s2">&quot;H2SO4&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">satice</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">],</span>
    <span class="s2">&quot;H2SO4&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Set up CARMA parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAParameters</span><span class="p">()</span>
<span class="n">params</span><span class="o">.</span><span class="n">nz</span> <span class="o">=</span> <span class="n">NZ</span>
<span class="n">params</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="n">NBIN</span>

<span class="c1"># Create sulfate group - simplified</span>
<span class="n">sulfate_group</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAGroupConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sulfate&quot;</span><span class="p">,</span>
    <span class="n">shortname</span><span class="o">=</span><span class="s2">&quot;SULF&quot;</span><span class="p">,</span>
    <span class="n">rmin</span><span class="o">=</span><span class="mf">2.e-10</span><span class="p">,</span>  <span class="c1"># Minimum radius in m</span>
    <span class="n">rmrat</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>   <span class="c1"># Mass ratio between bins</span>
    <span class="n">swelling_approach</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;algorithm&quot;</span><span class="p">:</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleSwellingAlgorithm</span><span class="o">.</span><span class="n">WEIGHT_PERCENT_H2SO4</span><span class="p">,</span>
        <span class="s2">&quot;composition&quot;</span><span class="p">:</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleSwellingComposition</span><span class="o">.</span><span class="n">NONE</span>
    <span class="p">},</span>
    <span class="n">do_drydep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">is_sulfate</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add_group</span><span class="p">(</span><span class="n">sulfate_group</span><span class="p">)</span>

<span class="c1"># Create sulfate element</span>
<span class="n">sulfate_element</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAElementConfig</span><span class="p">(</span>
    <span class="n">igroup</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Sulfate&quot;</span><span class="p">,</span>
    <span class="n">shortname</span><span class="o">=</span><span class="s2">&quot;SULF&quot;</span><span class="p">,</span>
    <span class="n">rho</span><span class="o">=</span><span class="n">rho_sulfate_kg_m3</span><span class="p">,</span>
    <span class="n">itype</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleType</span><span class="o">.</span><span class="n">VOLATILE</span><span class="p">,</span>
    <span class="n">icomposition</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleComposition</span><span class="o">.</span><span class="n">SULFURIC_ACID</span>
<span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add_element</span><span class="p">(</span><span class="n">sulfate_element</span><span class="p">)</span>

<span class="c1"># Create gases - simplified to match successful test_carma.py pattern</span>
<span class="n">water_gas</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAGasConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Water Vapor&quot;</span><span class="p">,</span>
    <span class="n">shortname</span><span class="o">=</span><span class="s2">&quot;H2O&quot;</span><span class="p">,</span>
    <span class="n">wtmol</span><span class="o">=</span><span class="mf">0.018015</span><span class="p">,</span>  <span class="c1"># kg/mol</span>
    <span class="n">ivaprtn</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">VaporizationAlgorithm</span><span class="o">.</span><span class="n">H2O_MURPHY_2005</span><span class="p">,</span>
    <span class="n">icomposition</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">GasComposition</span><span class="o">.</span><span class="n">H2O</span><span class="p">,</span>
    <span class="n">dgc_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">ds_threshold</span><span class="o">=</span><span class="mf">0.1</span>
<span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add_gas</span><span class="p">(</span><span class="n">water_gas</span><span class="p">)</span>

<span class="c1"># Create H2SO4 gas</span>
<span class="n">h2so4_gas</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAGasConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Sulfuric Acid&quot;</span><span class="p">,</span>
    <span class="n">shortname</span><span class="o">=</span><span class="s2">&quot;H2SO4&quot;</span><span class="p">,</span>
    <span class="n">wtmol</span><span class="o">=</span><span class="mf">0.098079</span><span class="p">,</span>  <span class="c1"># kg/mol</span>
    <span class="n">ivaprtn</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">VaporizationAlgorithm</span><span class="o">.</span><span class="n">H2SO4_AYERS_1980</span><span class="p">,</span>
    <span class="n">icomposition</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">GasComposition</span><span class="o">.</span><span class="n">H2SO4</span><span class="p">,</span>
    <span class="n">dgc_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="n">ds_threshold</span><span class="o">=</span><span class="mf">0.1</span>
<span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add_gas</span><span class="p">(</span><span class="n">h2so4_gas</span><span class="p">)</span>

<span class="c1"># Add growth process</span>
<span class="n">growth</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAGrowthConfig</span><span class="p">(</span>
    <span class="n">ielem</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Sulfate element</span>
    <span class="n">igas</span><span class="o">=</span><span class="mi">2</span>    <span class="c1"># H2SO4 gas</span>
<span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add_growth</span><span class="p">(</span><span class="n">growth</span><span class="p">)</span>

<span class="c1"># Add nucleation process</span>
<span class="n">nucleation</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMANucleationConfig</span><span class="p">(</span>
    <span class="n">ielemfrom</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ielemto</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleNucleationAlgorithm</span><span class="o">.</span><span class="n">HOMOGENEOUS_NUCLEATION</span><span class="p">,</span>
    <span class="n">rlh_nuc</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
    <span class="n">igas</span><span class="o">=</span><span class="mi">2</span>  <span class="c1"># H2SO4 gas</span>
<span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add_nucleation</span><span class="p">(</span><span class="n">nucleation</span><span class="p">)</span>

<span class="c1"># Add coagulation</span>
<span class="n">coagulation</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMACoagulationConfig</span><span class="p">(</span>
    <span class="n">igroup1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">igroup2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">igroup3</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleCollectionAlgorithm</span><span class="o">.</span><span class="n">FUCHS</span>
<span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">add_coagulation</span><span class="p">(</span><span class="n">coagulation</span><span class="p">)</span>

<span class="c1"># Initialization</span>
<span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">do_substep</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">do_thermo</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">maxretries</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">maxsubsteps</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">dt_threshold</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">sulfnucl_method</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">SulfateNucleationMethod</span><span class="o">.</span><span class="n">ZHAO_TURCO</span><span class="o">.</span><span class="n">value</span>

<span class="c1"># Create CARMA instance</span>
<span class="n">carma</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMA</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next we print out some group properties for each bin</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Output group properties</span>
<span class="n">group_props</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">carma</span><span class="o">.</span><span class="n">get_group_properties</span><span class="p">()</span>
<span class="c1"># Print bin radius and bin mass from group_props xarray Dataset</span>
<span class="k">for</span> <span class="n">i_bin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NBIN</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Bin </span><span class="si">{</span><span class="n">i_bin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">: bin radius = </span><span class="si">{</span><span class="n">group_props</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="nb">bin</span><span class="o">=</span><span class="n">i_bin</span><span class="p">)[</span><span class="s1">&#39;bin_radius&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">; bin mass = </span><span class="si">{</span><span class="n">group_props</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="nb">bin</span><span class="o">=</span><span class="n">i_bin</span><span class="p">)[</span><span class="s1">&#39;bin_mass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Bin 1: bin radius = 1.9999999552965185e-10; bin mass = 6.444035157118609e-26
Bin 2: bin radius = 2.519842043466889e-10; bin mass = 1.2888070314237217e-25
Bin 3: bin radius = 3.1748020329740454e-10; bin mass = 2.5776140628474434e-25
Bin 4: bin radius = 3.999999910593037e-10; bin mass = 5.155228125694887e-25
Bin 5: bin radius = 5.039684086933778e-10; bin mass = 1.0310456251389774e-24
Bin 6: bin radius = 6.349604065948091e-10; bin mass = 2.0620912502779548e-24
Bin 7: bin radius = 7.999999821186074e-10; bin mass = 4.1241825005559095e-24
Bin 8: bin radius = 1.0079368173867555e-09; bin mass = 8.248365001111819e-24
Bin 9: bin radius = 1.2699208131896181e-09; bin mass = 1.6496730002223638e-23
Bin 10: bin radius = 1.5999999642372146e-09; bin mass = 3.2993460004447276e-23
Bin 11: bin radius = 2.015873634773511e-09; bin mass = 6.598692000889455e-23
Bin 12: bin radius = 2.5398416263792355e-09; bin mass = 1.319738400177891e-22
Bin 13: bin radius = 3.199999928474429e-09; bin mass = 2.639476800355782e-22
Bin 14: bin radius = 4.031747269547022e-09; bin mass = 5.278953600711564e-22
Bin 15: bin radius = 5.079683252758471e-09; bin mass = 1.0557907201423128e-21
Bin 16: bin radius = 6.399999856948858e-09; bin mass = 2.1115814402846257e-21
Bin 17: bin radius = 8.063494539094043e-09; bin mass = 4.223162880569251e-21
Bin 18: bin radius = 1.0159366505516942e-08; bin mass = 8.446325761138503e-21
Bin 19: bin radius = 1.2799999713897717e-08; bin mass = 1.6892651522277005e-20
Bin 20: bin radius = 1.6126989078188085e-08; bin mass = 3.378530304455401e-20
Bin 21: bin radius = 2.0318733011033884e-08; bin mass = 6.757060608910802e-20
Bin 22: bin radius = 2.5599999427795427e-08; bin mass = 1.3514121217821604e-19
Bin 23: bin radius = 3.225397815637617e-08; bin mass = 2.702824243564321e-19
Bin 24: bin radius = 4.063746602206777e-08; bin mass = 5.405648487128642e-19
Bin 25: bin radius = 5.119999885559085e-08; bin mass = 1.0811296974257283e-18
Bin 26: bin radius = 6.450795631275234e-08; bin mass = 2.1622593948514567e-18
Bin 27: bin radius = 8.127493204413553e-08; bin mass = 4.324518789702913e-18
Bin 28: bin radius = 1.023999977111817e-07; bin mass = 8.649037579405827e-18
Bin 29: bin radius = 1.2901591262550466e-07; bin mass = 1.7298075158811654e-17
Bin 30: bin radius = 1.6254986408827104e-07; bin mass = 3.459615031762331e-17
Bin 31: bin radius = 2.047999954223634e-07; bin mass = 6.919230063524661e-17
Bin 32: bin radius = 2.580318252510093e-07; bin mass = 1.3838460127049323e-16
Bin 33: bin radius = 3.250997281765421e-07; bin mass = 2.7676920254098646e-16
Bin 34: bin radius = 4.0959999084472677e-07; bin mass = 5.535384050819729e-16
Bin 35: bin radius = 5.160636505020186e-07; bin mass = 1.1070768101639458e-15
Bin 36: bin radius = 6.501994563530842e-07; bin mass = 2.2141536203278916e-15
Bin 37: bin radius = 8.191999816894535e-07; bin mass = 4.428307240655783e-15
Bin 38: bin radius = 1.0321273010040372e-06; bin mass = 8.856614481311567e-15
</pre></div></div>
</div>
<p>Finally, we will run the box model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bin_state</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">gas_state</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">env_state</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">for</span> <span class="n">i_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsteps</span><span class="p">):</span>

    <span class="c1"># Create state</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">carma</span><span class="o">.</span><span class="n">create_state</span><span class="p">(</span>
        <span class="n">time_step</span><span class="o">=</span><span class="n">dtime</span><span class="p">,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="n">temperature_centers</span><span class="p">,</span>
        <span class="n">original_temperature</span><span class="o">=</span><span class="n">temperature_centers</span><span class="p">,</span>
        <span class="n">pressure</span><span class="o">=</span><span class="n">pressure_centers</span><span class="p">,</span>
        <span class="n">pressure_levels</span><span class="o">=</span><span class="n">pressure_levels</span><span class="p">,</span>
        <span class="n">vertical_center</span><span class="o">=</span><span class="n">vertical_center</span><span class="p">,</span>
        <span class="n">vertical_levels</span><span class="o">=</span><span class="n">vertical_levels</span><span class="p">,</span>
        <span class="n">longitude</span><span class="o">=</span><span class="n">longitude</span><span class="p">,</span>
        <span class="n">latitude</span><span class="o">=</span><span class="n">latitude</span><span class="p">,</span>
        <span class="n">coordinates</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CarmaCoordinates</span><span class="o">.</span><span class="n">CARTESIAN</span><span class="p">,</span>
        <span class="n">specific_humidity</span><span class="o">=</span><span class="n">mass_mixing_ratios</span><span class="p">[</span><span class="s2">&quot;H2O&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># Initialize particle concentrations to zero</span>
    <span class="k">for</span> <span class="n">ibin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NBIN</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">ielem</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NELEM</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">state</span><span class="o">.</span><span class="n">set_bin</span><span class="p">(</span><span class="n">ibin</span><span class="p">,</span> <span class="n">ielem</span><span class="p">,</span> <span class="n">mass_mixing_ratios</span><span class="p">[</span><span class="s2">&quot;SULFATE&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">ibin</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Set H2O concentration</span>
    <span class="n">state</span><span class="o">.</span><span class="n">set_gas</span><span class="p">(</span>
        <span class="n">gas_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="n">mass_mixing_ratios</span><span class="p">[</span><span class="s2">&quot;H2O&quot;</span><span class="p">],</span>
        <span class="n">old_mmr</span><span class="o">=</span><span class="n">mass_mixing_ratios</span><span class="p">[</span><span class="s2">&quot;H2O&quot;</span><span class="p">],</span>
        <span class="n">gas_saturation_wrt_ice</span><span class="o">=</span><span class="n">satice</span><span class="p">[</span><span class="s2">&quot;H2O&quot;</span><span class="p">],</span>
        <span class="n">gas_saturation_wrt_liquid</span><span class="o">=</span><span class="n">satliq</span><span class="p">[</span><span class="s2">&quot;H2O&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># Set H2SO4 concentration</span>
    <span class="n">state</span><span class="o">.</span><span class="n">set_gas</span><span class="p">(</span>
        <span class="n">gas_index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="n">mmr</span> <span class="o">*</span> <span class="mf">1.05</span> <span class="k">for</span> <span class="n">mmr</span> <span class="ow">in</span> <span class="n">mass_mixing_ratios</span><span class="p">[</span><span class="s2">&quot;H2SO4&quot;</span><span class="p">]],</span>
        <span class="n">old_mmr</span><span class="o">=</span><span class="n">mass_mixing_ratios</span><span class="p">[</span><span class="s2">&quot;H2SO4&quot;</span><span class="p">],</span>
        <span class="n">gas_saturation_wrt_ice</span><span class="o">=</span><span class="n">satice</span><span class="p">[</span><span class="s2">&quot;H2SO4&quot;</span><span class="p">],</span>
        <span class="n">gas_saturation_wrt_liquid</span><span class="o">=</span><span class="n">satliq</span><span class="p">[</span><span class="s2">&quot;H2SO4&quot;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># Perform model step</span>
    <span class="n">state</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

    <span class="c1"># Get updated state values</span>
    <span class="k">if</span> <span class="n">bin_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bin_state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get_bins</span><span class="p">()</span>
        <span class="n">bin_state</span> <span class="o">=</span> <span class="n">bin_state</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">i_step</span> <span class="o">*</span> <span class="n">dtime</span><span class="p">]})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bin_state</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">bin_state</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">get_bins</span><span class="p">()</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">i_step</span> <span class="o">*</span> <span class="n">dtime</span><span class="p">]})],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">gas_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gas_state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get_gases</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">gas_state</span> <span class="o">=</span> <span class="n">gas_state</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">i_step</span> <span class="o">*</span> <span class="n">dtime</span><span class="p">]})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gas_state</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">gas_state</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">get_gases</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">i_step</span> <span class="o">*</span> <span class="n">dtime</span><span class="p">]})],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">env_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">env_state</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get_environmental_values</span><span class="p">()</span>
        <span class="n">env_state</span> <span class="o">=</span> <span class="n">env_state</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">i_step</span> <span class="o">*</span> <span class="n">dtime</span><span class="p">]})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">env_state</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">env_state</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">get_environmental_values</span><span class="p">(</span>
        <span class="p">)</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">i_step</span> <span class="o">*</span> <span class="n">dtime</span><span class="p">]})],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">bin_data</span><span class="p">,</span> <span class="n">env_state</span><span class="p">,</span> <span class="n">gas_state</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 177kB
Dimensions:                         (time: 240, bin: 5, element: 1,
                                     vertical_center: 1, vertical_level: 2,
                                     gas: 2)
Coordinates:
  * time                            (time) float64 2kB 0.0 1.8e+03 ... 4.302e+05
  * bin                             (bin) int64 40B 1 2 3 4 5
  * element                         (element) int64 8B 1
  * vertical_center                 (vertical_center) float64 8B 1.7e+04
  * vertical_level                  (vertical_level) float64 16B 1.65e+04 1.7...
  * gas                             (gas) &lt;U5 40B &#x27;H2O&#x27; &#x27;H2SO4&#x27;
Data variables: (12/24)
    mass_mixing_ratio               (time, bin, element, vertical_center) float64 10kB ...
    number_mixing_ratio             (time, bin, element, vertical_center) float64 10kB ...
    number_density                  (time, bin, element, vertical_center) float64 10kB ...
    nucleation_rate                 (time, bin, element, vertical_center) float64 10kB ...
    wet_particle_radius             (time, bin, element, vertical_center) float64 10kB ...
    wet_particle_density            (time, bin, element, vertical_center) float64 10kB ...
    ...                              ...
    gas_mass_mixing_ratio           (time, gas, vertical_center) float64 4kB ...
    gas_saturation_wrt_ice          (time, gas, vertical_center) float64 4kB ...
    gas_saturation_wrt_liquid       (time, gas, vertical_center) float64 4kB ...
    gas_vapor_pressure_wrt_ice      (time, gas, vertical_center) float64 4kB ...
    gas_vapor_pressure_wrt_liquid   (time, gas, vertical_center) float64 4kB ...
    weight_pct_aerosol_composition  (time, gas, vertical_center) float64 4kB ...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-22d49233-c1bc-4132-b1c2-d69a97554d86' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-22d49233-c1bc-4132-b1c2-d69a97554d86' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 240</li><li><span class='xr-has-index'>bin</span>: 5</li><li><span class='xr-has-index'>element</span>: 1</li><li><span class='xr-has-index'>vertical_center</span>: 1</li><li><span class='xr-has-index'>vertical_level</span>: 2</li><li><span class='xr-has-index'>gas</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7107da48-1a96-4341-bdd2-1eaeea189b36' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7107da48-1a96-4341-bdd2-1eaeea189b36' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.8e+03 ... 4.284e+05 4.302e+05</div><input id='attrs-f6f45b9f-2c05-4b29-97c9-62f17299fe5d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f6f45b9f-2c05-4b29-97c9-62f17299fe5d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c7b6ce8-e8fd-4763-b4fa-f5ca17c6eb82' class='xr-var-data-in' type='checkbox'><label for='data-0c7b6ce8-e8fd-4763-b4fa-f5ca17c6eb82' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([     0.,   1800.,   3600., ..., 426600., 428400., 430200.], shape=(240,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>bin</span></div><div class='xr-var-dims'>(bin)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 5</div><input id='attrs-d0a3555d-f87c-4a17-bcf1-ade6bfdc14dd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d0a3555d-f87c-4a17-bcf1-ade6bfdc14dd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ba9343e2-188c-4af9-9b30-fdb1cddfd454' class='xr-var-data-in' type='checkbox'><label for='data-ba9343e2-188c-4af9-9b30-fdb1cddfd454' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 2, 3, 4, 5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>element</span></div><div class='xr-var-dims'>(element)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-cad25aa7-c73b-4032-aa62-4c375f5937f5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cad25aa7-c73b-4032-aa62-4c375f5937f5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b161ce30-50ab-4dee-8d8e-b3c439180822' class='xr-var-data-in' type='checkbox'><label for='data-b161ce30-50ab-4dee-8d8e-b3c439180822' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>vertical_center</span></div><div class='xr-var-dims'>(vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.7e+04</div><input id='attrs-6f23b992-49c9-474d-8436-f4d3299b8009' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6f23b992-49c9-474d-8436-f4d3299b8009' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd9da3a8-9466-4fe4-bfd7-b7b412a98600' class='xr-var-data-in' type='checkbox'><label for='data-fd9da3a8-9466-4fe4-bfd7-b7b412a98600' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([17000.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>vertical_level</span></div><div class='xr-var-dims'>(vertical_level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.65e+04 1.75e+04</div><input id='attrs-fa472105-ec4e-4e70-a9a5-3fe7653e13ce' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fa472105-ec4e-4e70-a9a5-3fe7653e13ce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c749fd9a-7dfd-438e-b04a-5a91fad9f815' class='xr-var-data-in' type='checkbox'><label for='data-c749fd9a-7dfd-438e-b04a-5a91fad9f815' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([16500., 17500.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>gas</span></div><div class='xr-var-dims'>(gas)</div><div class='xr-var-dtype'>&lt;U5</div><div class='xr-var-preview xr-preview'>&#x27;H2O&#x27; &#x27;H2SO4&#x27;</div><input id='attrs-c3ba8acf-9c27-47f7-9a14-62b396a939c4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c3ba8acf-9c27-47f7-9a14-62b396a939c4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3b7af833-08ac-479d-919d-497834e90993' class='xr-var-data-in' type='checkbox'><label for='data-3b7af833-08ac-479d-919d-497834e90993' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;H2O&#x27;, &#x27;H2SO4&#x27;], dtype=&#x27;&lt;U5&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e4c79a9e-57ed-40f8-a1b6-e17cd67e950d' class='xr-section-summary-in' type='checkbox'  ><label for='section-e4c79a9e-57ed-40f8-a1b6-e17cd67e950d' class='xr-section-summary' >Data variables: <span>(24)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>mass_mixing_ratio</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.365e-07 1.365e-07 ... 1.453e-07</div><input id='attrs-0008acd3-290c-49d2-b83a-0af283b72ee3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0008acd3-290c-49d2-b83a-0af283b72ee3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d67e7be9-39a6-4bbd-849c-2ca455349d7c' class='xr-var-data-in' type='checkbox'><label for='data-d67e7be9-39a6-4bbd-849c-2ca455349d7c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg kg-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle mass mixing ratio</dd></dl></div><div class='xr-var-data'><pre>array([[[[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]]],


       [[[1.36427335e-07]],

        [[1.36453356e-07]],

        [[1.36471940e-07]],

        [[1.36477617e-07]],

        [[1.36503414e-07]]],
...
       [[[1.27520200e-07]],

        [[1.33176857e-07]],

        [[1.37461746e-07]],

        [[1.38929726e-07]],

        [[1.45245134e-07]]],


       [[[1.27484358e-07]],

        [[1.33162640e-07]],

        [[1.37464927e-07]],

        [[1.38939528e-07]],

        [[1.45282210e-07]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>number_mixing_ratio</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>8.299e+08 4.149e+08 ... 5.522e+07</div><input id='attrs-3b1afc1a-1dc4-4011-8f79-657f5c809f56' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3b1afc1a-1dc4-4011-8f79-657f5c809f56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3e794c93-cab7-498e-9b4a-dff8a8309533' class='xr-var-data-in' type='checkbox'><label for='data-3e794c93-cab7-498e-9b4a-dff8a8309533' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle number mixing ratio</dd></dl></div><div class='xr-var-data'><pre>array([[[[8.29899894e+08]],

        [[4.14949947e+08]],

        [[2.07474974e+08]],

        [[1.03737487e+08]],

        [[5.18687434e+07]]],


       [[[8.29660306e+08]],

        [[4.14909273e+08]],

        [[2.07482891e+08]],

        [[1.03745761e+08]],

        [[5.18826855e+07]]],
...
       [[[7.75493033e+08]],

        [[4.04946530e+08]],

        [[2.08987726e+08]],

        [[1.05609773e+08]],

        [[5.52052684e+07]]],


       [[[7.75275068e+08]],

        [[4.04903301e+08]],

        [[2.08992562e+08]],

        [[1.05617224e+08]],

        [[5.52193600e+07]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>number_density</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.176e+08 5.88e+07 ... 7.825e+06</div><input id='attrs-9d757bcf-fade-44db-91c9-ebe590941dfa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9d757bcf-fade-44db-91c9-ebe590941dfa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ed141ba7-d5e6-49ad-a84d-1e9f1fbb8bb3' class='xr-var-data-in' type='checkbox'><label for='data-ed141ba7-d5e6-49ad-a84d-1e9f1fbb8bb3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m-3</dd><dt><span>long_name :</span></dt><dd>Aerosol particle number density</dd></dl></div><div class='xr-var-data'><pre>array([[[[1.17595615e+08]],

        [[5.87978075e+07]],

        [[2.93989038e+07]],

        [[1.46994519e+07]],

        [[7.34972594e+06]]],


       [[[1.17561666e+08]],

        [[5.87920441e+07]],

        [[2.94000256e+07]],

        [[1.47006243e+07]],

        [[7.35170152e+06]]],
...
       [[[1.09886241e+08]],

        [[5.73803377e+07]],

        [[2.96132586e+07]],

        [[1.49647521e+07]],

        [[7.82250670e+06]]],


       [[[1.09855356e+08]],

        [[5.73742124e+07]],

        [[2.96139439e+07]],

        [[1.49658079e+07]],

        [[7.82450347e+06]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nucleation_rate</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.99e+08 -9.99e+08 ... -9.99e+08</div><input id='attrs-7feb213f-30c2-410c-b1c2-c98ed5b6db41' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7feb213f-30c2-410c-b1c2-c98ed5b6db41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4cee2b13-98ac-44be-bcbb-aa42cc48188e' class='xr-var-data-in' type='checkbox'><label for='data-4cee2b13-98ac-44be-bcbb-aa42cc48188e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m-3 s-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle nucleation rate</dd></dl></div><div class='xr-var-data'><pre>array([[[[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]]],


       [[[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]]],
...
       [[[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]]],


       [[[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]],

        [[-9.99e+08]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wet_particle_radius</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 4.3e-05 5.418e-05</div><input id='attrs-46222b17-f83c-4c81-8d14-58d6f16f9a4a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-46222b17-f83c-4c81-8d14-58d6f16f9a4a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d22ffea4-c8e1-4e10-ba7f-822e6b6b41dd' class='xr-var-data-in' type='checkbox'><label for='data-d22ffea4-c8e1-4e10-ba7f-822e6b6b41dd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>Wet aerosol particle radius</dd></dl></div><div class='xr-var-data'><pre>array([[[[0.00000000e+00]],

        [[0.00000000e+00]],

        [[0.00000000e+00]],

        [[0.00000000e+00]],

        [[0.00000000e+00]]],


       [[[2.14999995e-05]],

        [[2.70883020e-05]],

        [[3.41291219e-05]],

        [[4.29999990e-05]],

        [[5.41766039e-05]]],
...
       [[[2.14999995e-05]],

        [[2.70883020e-05]],

        [[3.41291219e-05]],

        [[4.29999990e-05]],

        [[5.41766039e-05]]],


       [[[2.14999995e-05]],

        [[2.70883020e-05]],

        [[3.41291219e-05]],

        [[4.29999990e-05]],

        [[5.41766039e-05]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wet_particle_density</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 0.00395 0.00395</div><input id='attrs-90025cb0-e71c-4d03-8c4c-65863f75c908' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-90025cb0-e71c-4d03-8c4c-65863f75c908' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-007aad59-9782-4097-89d9-0ce8a954467d' class='xr-var-data-in' type='checkbox'><label for='data-007aad59-9782-4097-89d9-0ce8a954467d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-3</dd><dt><span>long_name :</span></dt><dd>Wet aerosol particle density</dd></dl></div><div class='xr-var-data'><pre>array([[[[0.     ]],

        [[0.     ]],

        [[0.     ]],

        [[0.     ]],

        [[0.     ]]],


       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]],
...
       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]],


       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dry_particle_density</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 0.00395 0.00395</div><input id='attrs-61ca5609-3448-493d-a194-0f9e83b3a0ee' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-61ca5609-3448-493d-a194-0f9e83b3a0ee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a5ae22a-4347-4d80-ba50-d80b92243a3e' class='xr-var-data-in' type='checkbox'><label for='data-7a5ae22a-4347-4d80-ba50-d80b92243a3e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-3</dd><dt><span>long_name :</span></dt><dd>Dry aerosol particle density</dd></dl></div><div class='xr-var-data'><pre>array([[[[0.     ]],

        [[0.     ]],

        [[0.     ]],

        [[0.     ]],

        [[0.     ]]],


       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]],
...
       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]],


       [[[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]],

        [[0.00395]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>delta_particle_temperature</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-999.0 -999.0 ... -999.0 -999.0</div><input id='attrs-0be6473d-3c84-4850-91f4-fddb816ab075' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0be6473d-3c84-4850-91f4-fddb816ab075' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4cfb2bac-8e56-4ea9-aea0-d6a75df5ef2e' class='xr-var-data-in' type='checkbox'><label for='data-4cfb2bac-8e56-4ea9-aea0-d6a75df5ef2e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Aerosol particle temperature change</dd></dl></div><div class='xr-var-data'><pre>array([[[[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]]],


       [[[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]]],
...
       [[[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]]],


       [[[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]],

        [[-999.]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>kappa</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 ... -1.798e+308 -1.798e+308</div><input id='attrs-4079db95-0aae-475b-ace4-1f5aa95181bd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4079db95-0aae-475b-ace4-1f5aa95181bd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-08da9d21-fa89-4604-89d3-6608c58edea3' class='xr-var-data-in' type='checkbox'><label for='data-08da9d21-fa89-4604-89d3-6608c58edea3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>-</dd><dt><span>long_name :</span></dt><dd>Aerosol particle hygroscopicity parameter</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 0.00000000e+000]],

        [[ 0.00000000e+000]],

        [[ 0.00000000e+000]],

        [[ 0.00000000e+000]],

        [[ 0.00000000e+000]]],


       [[[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]]],
...
       [[[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]]],


       [[[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]],

        [[-1.79769313e+308]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>total_mass_mixing_ratio</span></div><div class='xr-var-dims'>(time, bin, element, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.365e-07 1.365e-07 ... 1.453e-07</div><input id='attrs-8480c6d3-3e1a-4c7f-be89-e14b099532fc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8480c6d3-3e1a-4c7f-be89-e14b099532fc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-433d17a3-6360-4d6c-97e2-c51c9b158f53' class='xr-var-data-in' type='checkbox'><label for='data-433d17a3-6360-4d6c-97e2-c51c9b158f53' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-3</dd><dt><span>long_name :</span></dt><dd>Total aerosol particle mass mixing ratio</dd></dl></div><div class='xr-var-data'><pre>array([[[[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]],

        [[1.36466733e-07]]],


       [[[1.36427335e-07]],

        [[1.36453356e-07]],

        [[1.36471940e-07]],

        [[1.36477617e-07]],

        [[1.36503414e-07]]],
...
       [[[1.27520200e-07]],

        [[1.33176857e-07]],

        [[1.37461746e-07]],

        [[1.38929726e-07]],

        [[1.45245134e-07]]],


       [[[1.27484358e-07]],

        [[1.33162640e-07]],

        [[1.37464927e-07]],

        [[1.38939528e-07]],

        [[1.45282210e-07]]]], shape=(240, 5, 1, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fall_velocity</span></div><div class='xr-var-dims'>(time, bin, element, vertical_level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.99 -9.99 -9.99 ... -9.99 -9.99</div><input id='attrs-90f9547e-e7a4-4537-b9c6-0d6de8156ee0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-90f9547e-e7a4-4537-b9c6-0d6de8156ee0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6885e011-f01d-4b61-bc0a-a643cb637eb9' class='xr-var-data-in' type='checkbox'><label for='data-6885e011-f01d-4b61-bc0a-a643cb637eb9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle fall velocity</dd></dl></div><div class='xr-var-data'><pre>array([[[[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]]],


       [[[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]]],
...
       [[[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]]],


       [[[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]],

        [[-9.98999978, -9.98999978]]]], shape=(240, 5, 1, 2))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>particle_mass_on_surface</span></div><div class='xr-var-dims'>(time, bin, element)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-f906fd17-18bd-49da-ab23-220b87bf0c97' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f906fd17-18bd-49da-ab23-220b87bf0c97' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dd2ef4e9-f8a0-4124-aadd-c42537250362' class='xr-var-data-in' type='checkbox'><label for='data-dd2ef4e9-f8a0-4124-aadd-c42537250362' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-2</dd><dt><span>long_name :</span></dt><dd>Aerosol particle mass on surface</dd></dl></div><div class='xr-var-data'><pre>array([[[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       ...,

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]]], shape=(240, 5, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sedimentation_flux</span></div><div class='xr-var-dims'>(time, bin, element)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-8a62acdb-eeb1-410f-b6fe-d5bc77a85f62' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8a62acdb-eeb1-410f-b6fe-d5bc77a85f62' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e46ab00c-04b1-4fa8-9ae5-e1f7035363f7' class='xr-var-data-in' type='checkbox'><label for='data-e46ab00c-04b1-4fa8-9ae5-e1f7035363f7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-2 s-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle sedimentation flux</dd></dl></div><div class='xr-var-data'><pre>array([[[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       ...,

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]],

       [[0.],
        [0.],
        [0.],
        [0.],
        [0.]]], shape=(240, 5, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>deposition_velocity</span></div><div class='xr-var-dims'>(time, bin, element)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.99 -9.99 -9.99 ... -9.99 -9.99</div><input id='attrs-41ef6933-ca1a-469c-8fe8-cd9387999cad' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-41ef6933-ca1a-469c-8fe8-cd9387999cad' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1c32a46f-57d8-43ce-aa3b-a4d1f4af3bd1' class='xr-var-data-in' type='checkbox'><label for='data-1c32a46f-57d8-43ce-aa3b-a4d1f4af3bd1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>long_name :</span></dt><dd>Aerosol particle deposition velocity</dd></dl></div><div class='xr-var-data'><pre>array([[[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]],

       [[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]],

       [[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]],

       ...,

       [[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]],

       [[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]],

       [[-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978],
        [-9.98999978]]], shape=(240, 5, 1))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temperature</span></div><div class='xr-var-dims'>(time, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>250.0 250.0 250.0 ... nan nan nan</div><input id='attrs-8b5e6722-cf3d-4d4e-a09b-7d39d1341715' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8b5e6722-cf3d-4d4e-a09b-7d39d1341715' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3cf51bb-50a1-47bb-8aae-86f41c7151c7' class='xr-var-data-in' type='checkbox'><label for='data-a3cf51bb-50a1-47bb-8aae-86f41c7151c7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Temperature</dd></dl></div><div class='xr-var-data'><pre>array([[250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
       [250.],
...
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan],
       [ nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pressure</span></div><div class='xr-var-dims'>(time, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>9e+03 9e+03 9e+03 ... nan nan nan</div><input id='attrs-0bb95f5a-8125-4f58-96a7-d42d75a8fb45' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0bb95f5a-8125-4f58-96a7-d42d75a8fb45' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9e3c8c5c-d3c9-44f8-9de5-e0df3fcdab8b' class='xr-var-data-in' type='checkbox'><label for='data-9e3c8c5c-d3c9-44f8-9de5-e0df3fcdab8b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>Pa</dd><dt><span>long_name :</span></dt><dd>Pressure</dd></dl></div><div class='xr-var-data'><pre>array([[9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
       [9000.],
...
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan],
       [  nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>air_density</span></div><div class='xr-var-dims'>(time, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.1254 0.1254 0.1254 ... nan nan</div><input id='attrs-3b584344-730b-4576-b476-69ef4c73386c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3b584344-730b-4576-b476-69ef4c73386c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b09aebbc-f600-4055-87ac-c1618e55261f' class='xr-var-data-in' type='checkbox'><label for='data-b09aebbc-f600-4055-87ac-c1618e55261f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m-3</dd><dt><span>long_name :</span></dt><dd>Air density</dd></dl></div><div class='xr-var-data'><pre>array([[0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
       [0.12541958],
...
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan],
       [       nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latent_heat</span></div><div class='xr-var-dims'>(time, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.949e-17 2.949e-17 ... nan nan</div><input id='attrs-813dbd35-2347-40c6-870c-8c3a84c68bd4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-813dbd35-2347-40c6-870c-8c3a84c68bd4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8d03d38c-2217-4cca-82d0-f14b156cb0c5' class='xr-var-data-in' type='checkbox'><label for='data-8d03d38c-2217-4cca-82d0-f14b156cb0c5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K s-1</dd><dt><span>long_name :</span></dt><dd>Latent heat release rate</dd></dl></div><div class='xr-var-data'><pre>array([[2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
       [2.94915237e-17],
...
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan],
       [           nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>gas_mass_mixing_ratio</span></div><div class='xr-var-dims'>(time, gas, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001 3.548e-10 0.0001 ... nan nan</div><input id='attrs-969e9361-0625-4152-a0a4-5ab9fcb280a8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-969e9361-0625-4152-a0a4-5ab9fcb280a8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20e09e4c-2f69-4b58-8d1b-ada25af779e5' class='xr-var-data-in' type='checkbox'><label for='data-20e09e4c-2f69-4b58-8d1b-ada25af779e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg kg-1</dd></dl></div><div class='xr-var-data'><pre>array([[[1.00000000e-04],
        [3.54827565e-10]],

       [[1.00000000e-04],
        [3.54827565e-10]],

       [[1.00000000e-04],
        [3.54827565e-10]],

       [[1.00000000e-04],
        [3.54827565e-10]],

       [[1.00000000e-04],
        [3.54827565e-10]],

       [[1.00000000e-04],
        [3.54827565e-10]],

       [[1.00000000e-04],
        [3.54827565e-10]],
...
       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>gas_saturation_wrt_ice</span></div><div class='xr-var-dims'>(time, gas, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.01903 2.305e+03 ... nan nan</div><input id='attrs-e752f51a-31fa-4ddf-a8f0-2ce5db2a6fb3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e752f51a-31fa-4ddf-a8f0-2ce5db2a6fb3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2fda6c68-458f-486d-83ab-07e061e6da9e' class='xr-var-data-in' type='checkbox'><label for='data-2fda6c68-458f-486d-83ab-07e061e6da9e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>none</dd></dl></div><div class='xr-var-data'><pre>array([[[1.90347283e-02],
        [2.30484121e+03]],

       [[1.90347283e-02],
        [2.30484121e+03]],

       [[1.90347283e-02],
        [2.30484121e+03]],

       [[1.90347283e-02],
        [2.30484121e+03]],

       [[1.90347283e-02],
        [2.30484121e+03]],

       [[1.90347283e-02],
        [2.30484121e+03]],

       [[1.90347283e-02],
        [2.30484121e+03]],
...
       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>gas_saturation_wrt_liquid</span></div><div class='xr-var-dims'>(time, gas, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.01518 2.305e+03 ... nan nan</div><input id='attrs-4dbc8c85-d34a-4f89-b470-173e481633c5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4dbc8c85-d34a-4f89-b470-173e481633c5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ce0224f4-b027-4568-9aa5-2294b04477f0' class='xr-var-data-in' type='checkbox'><label for='data-ce0224f4-b027-4568-9aa5-2294b04477f0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>none</dd></dl></div><div class='xr-var-data'><pre>array([[[1.51844156e-02],
        [2.30484121e+03]],

       [[1.51844156e-02],
        [2.30484121e+03]],

       [[1.51844156e-02],
        [2.30484121e+03]],

       [[1.51844156e-02],
        [2.30484121e+03]],

       [[1.51844156e-02],
        [2.30484121e+03]],

       [[1.51844156e-02],
        [2.30484121e+03]],

       [[1.51844156e-02],
        [2.30484121e+03]],
...
       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>gas_vapor_pressure_wrt_ice</span></div><div class='xr-var-dims'>(time, gas, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.008447 4.547e-14 ... nan nan</div><input id='attrs-d81305b4-b96e-4530-93f6-46c4425afd9e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d81305b4-b96e-4530-93f6-46c4425afd9e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62ed7949-bc1f-417e-a28a-ea7bc302bf0b' class='xr-var-data-in' type='checkbox'><label for='data-62ed7949-bc1f-417e-a28a-ea7bc302bf0b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>none</dd></dl></div><div class='xr-var-data'><pre>array([[[8.44709889e-03],
        [4.54662189e-14]],

       [[8.44709889e-03],
        [4.54662189e-14]],

       [[8.44709889e-03],
        [4.54662189e-14]],

       [[8.44709889e-03],
        [4.54662189e-14]],

       [[8.44709889e-03],
        [4.54662189e-14]],

       [[8.44709889e-03],
        [4.54662189e-14]],

       [[8.44709889e-03],
        [4.54662189e-14]],
...
       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>gas_vapor_pressure_wrt_liquid</span></div><div class='xr-var-dims'>(time, gas, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.01059 4.547e-14 ... nan nan</div><input id='attrs-8cb1a45d-4694-4890-b0e4-4a8a4113e96d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8cb1a45d-4694-4890-b0e4-4a8a4113e96d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-616c49af-1718-419f-ae75-9764d852651c' class='xr-var-data-in' type='checkbox'><label for='data-616c49af-1718-419f-ae75-9764d852651c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>none</dd></dl></div><div class='xr-var-data'><pre>array([[[1.05890300e-02],
        [4.54662189e-14]],

       [[1.05890300e-02],
        [4.54662189e-14]],

       [[1.05890300e-02],
        [4.54662189e-14]],

       [[1.05890300e-02],
        [4.54662189e-14]],

       [[1.05890300e-02],
        [4.54662189e-14]],

       [[1.05890300e-02],
        [4.54662189e-14]],

       [[1.05890300e-02],
        [4.54662189e-14]],
...
       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]],

       [[           nan],
        [           nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>weight_pct_aerosol_composition</span></div><div class='xr-var-dims'>(time, gas, vertical_center)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>72.52 72.52 72.52 ... nan nan nan</div><input id='attrs-cd80cb88-fb93-43c9-af18-ef2cf9a21ca4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cd80cb88-fb93-43c9-af18-ef2cf9a21ca4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b6e2fdc0-c792-466b-bb64-f37eaf272b83' class='xr-var-data-in' type='checkbox'><label for='data-b6e2fdc0-c792-466b-bb64-f37eaf272b83' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>none</dd></dl></div><div class='xr-var-data'><pre>array([[[72.52259169],
        [72.52259169]],

       [[72.52259169],
        [72.52259169]],

       [[72.52259169],
        [72.52259169]],

       [[72.52259169],
        [72.52259169]],

       [[72.52259169],
        [72.52259169]],

       [[72.52259169],
        [72.52259169]],

       [[72.52259169],
        [72.52259169]],
...
       [[        nan],
        [        nan]],

       [[        nan],
        [        nan]],

       [[        nan],
        [        nan]],

       [[        nan],
        [        nan]],

       [[        nan],
        [        nan]],

       [[        nan],
        [        nan]],

       [[        nan],
        [        nan]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1bfb5a75-1076-4aba-b2c4-c8be7eaec31d' class='xr-section-summary-in' type='checkbox'  ><label for='section-1bfb5a75-1076-4aba-b2c4-c8be7eaec31d' class='xr-section-summary' >Indexes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a2d51bdf-bf58-4aae-8308-7ef2de6e31fd' class='xr-index-data-in' type='checkbox'/><label for='index-a2d51bdf-bf58-4aae-8308-7ef2de6e31fd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([     0.0,   1800.0,   3600.0,   5400.0,   7200.0,   9000.0,  10800.0,
        12600.0,  14400.0,  16200.0,
       ...
       414000.0, 415800.0, 417600.0, 419400.0, 421200.0, 423000.0, 424800.0,
       426600.0, 428400.0, 430200.0],
      dtype=&#x27;float64&#x27;, name=&#x27;time&#x27;, length=240))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>bin</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-70c0691e-b7db-4651-9214-6a3d65ea0fec' class='xr-index-data-in' type='checkbox'/><label for='index-70c0691e-b7db-4651-9214-6a3d65ea0fec' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1, 2, 3, 4, 5], dtype=&#x27;int64&#x27;, name=&#x27;bin&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>element</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-52e82f83-c80f-4a78-a758-823e10af5e6e' class='xr-index-data-in' type='checkbox'/><label for='index-52e82f83-c80f-4a78-a758-823e10af5e6e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1], dtype=&#x27;int64&#x27;, name=&#x27;element&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>vertical_center</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b20d5e84-ee8d-431d-8183-4089acbc0c81' class='xr-index-data-in' type='checkbox'/><label for='index-b20d5e84-ee8d-431d-8183-4089acbc0c81' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([17000.0], dtype=&#x27;float64&#x27;, name=&#x27;vertical_center&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>vertical_level</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-f8697ac4-7f21-496e-96b6-cef504aded27' class='xr-index-data-in' type='checkbox'/><label for='index-f8697ac4-7f21-496e-96b6-cef504aded27' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([16500.0, 17500.0], dtype=&#x27;float64&#x27;, name=&#x27;vertical_level&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>gas</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-a975690c-ec6a-453a-abca-90c19ef860a8' class='xr-index-data-in' type='checkbox'/><label for='index-a975690c-ec6a-453a-abca-90c19ef860a8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;H2O&#x27;, &#x27;H2SO4&#x27;], dtype=&#x27;object&#x27;, name=&#x27;gas&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-734c07b3-102a-4ba9-a4a4-b2c587fd43d5' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-734c07b3-102a-4ba9-a4a4-b2c587fd43d5' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
</section>
<section id="Sulfates-with-gas-phase-concentrations-from-a-box-model">
<h1>Sulfates with gas-phase concentrations from a box model<a class="headerlink" href="#Sulfates-with-gas-phase-concentrations-from-a-box-model" title="Link to this heading">#</a></h1>
<p>Now we are going to get really fancy and solve the gas phase with MICM and feed those values into CARMA. First up we will create a gas-phase mechanism.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MOLEC_CM3_TO_MOLE_M3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1.0e6</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">6.022e23</span><span class="p">)</span>  <span class="c1"># Convert from molecules/cm³ to moles/m³</span>
<span class="n">NUMBER_OF_GRID_CELLS</span> <span class="o">=</span> <span class="mi">120</span>  <span class="c1"># Number of grid cells for the simulation</span>
<span class="n">NUMBER_OF_AEROSOL_SECTIONS</span> <span class="o">=</span> <span class="mi">38</span>  <span class="c1"># Number of aerosol sections for the simulation</span>
<span class="n">DENSITY_SULFATE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1923.0</span><span class="p">)</span>  <span class="c1"># Density of sulfate in kg/m³</span>
<span class="n">MOLECULAR_MASS_H2O</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.01801528</span><span class="p">)</span>  <span class="c1"># kg/mol</span>
<span class="n">MOLECULAR_MASS_H2SO4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.098078479</span><span class="p">)</span>  <span class="c1"># kg/mol</span>
<span class="n">MOLECULAR_MASS_AIR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.029</span><span class="p">)</span>  <span class="c1"># kg/mol (average molecular mass of air)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">create_mechanism</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a chemical mechanism for the gas-phase reactions involved in sulfate formation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">HO2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;HO2&quot;</span><span class="p">)</span>
    <span class="n">H2O2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;H2O2&quot;</span><span class="p">)</span>
    <span class="n">OH</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;OH&quot;</span><span class="p">,</span> <span class="n">constant_mixing_ratio_mol_mol</span><span class="o">=</span><span class="mf">0.8e-11</span><span class="p">)</span>
    <span class="n">SO2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;SO2&quot;</span><span class="p">)</span>
    <span class="n">SO3</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;SO3&quot;</span><span class="p">)</span>
    <span class="n">H2SO4</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;H2SO4&quot;</span><span class="p">)</span>
    <span class="n">H2O</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;H2O&quot;</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">is_third_body</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">gas</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Phase</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;gas&quot;</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="n">HO2</span><span class="p">,</span> <span class="n">H2O2</span><span class="p">,</span> <span class="n">OH</span><span class="p">,</span> <span class="n">SO2</span><span class="p">,</span> <span class="n">SO3</span><span class="p">,</span> <span class="n">H2SO4</span><span class="p">,</span> <span class="n">H2O</span><span class="p">,</span> <span class="n">M</span><span class="p">])</span>

    <span class="n">rxn_2HO2_H2O2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Arrhenius</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;2HO2 -&gt; H2O2&quot;</span><span class="p">,</span>
        <span class="n">reactants</span><span class="o">=</span><span class="p">[</span><span class="n">HO2</span><span class="p">,</span> <span class="n">HO2</span><span class="p">],</span>
        <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">H2O2</span><span class="p">],</span>
        <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span><span class="p">,</span>
        <span class="n">A</span><span class="o">=</span><span class="mf">3.0e-13</span> <span class="o">/</span> <span class="n">MOLEC_CM3_TO_MOLE_M3</span><span class="p">,</span>
        <span class="n">Ea</span><span class="o">=-</span><span class="mf">6.35099e-21</span><span class="p">)</span>

    <span class="n">rxn_2HO2_M_H2O2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Arrhenius</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;2HO2 + M -&gt; H2O2&quot;</span><span class="p">,</span>
        <span class="n">reactants</span><span class="o">=</span><span class="p">[</span><span class="n">HO2</span><span class="p">,</span> <span class="n">HO2</span><span class="p">,</span> <span class="n">M</span><span class="p">],</span>
        <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">H2O2</span><span class="p">],</span>
        <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span><span class="p">,</span>
        <span class="n">A</span><span class="o">=</span><span class="mf">2.1e-33</span> <span class="o">/</span> <span class="p">(</span><span class="n">MOLEC_CM3_TO_MOLE_M3</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">Ea</span><span class="o">=-</span><span class="mf">1.2702e-20</span><span class="p">)</span>

    <span class="n">rxn_2HO2_H2O_H2O2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Arrhenius</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;2H2O2 + H2O -&gt; H2O2 + H2O&quot;</span><span class="p">,</span>
        <span class="n">reactants</span><span class="o">=</span><span class="p">[</span><span class="n">HO2</span><span class="p">,</span> <span class="n">HO2</span><span class="p">,</span> <span class="n">H2O</span><span class="p">],</span>
        <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">H2O2</span><span class="p">,</span> <span class="n">H2O</span><span class="p">],</span>
        <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span><span class="p">,</span>
        <span class="n">A</span><span class="o">=</span><span class="mf">4.2e-34</span> <span class="o">/</span> <span class="p">(</span><span class="n">MOLEC_CM3_TO_MOLE_M3</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">Ea</span><span class="o">=-</span><span class="mf">3.67253e-20</span><span class="p">)</span>

    <span class="n">rxn_2HO2_H2O_M_H2O2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Arrhenius</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;2HO2 + H2O + M -&gt; H2O2 + H2O&quot;</span><span class="p">,</span>
        <span class="n">reactants</span><span class="o">=</span><span class="p">[</span><span class="n">HO2</span><span class="p">,</span> <span class="n">HO2</span><span class="p">,</span> <span class="n">H2O</span><span class="p">,</span> <span class="n">M</span><span class="p">],</span>
        <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">H2O2</span><span class="p">,</span> <span class="n">H2O</span><span class="p">],</span>
        <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span><span class="p">,</span>
        <span class="n">A</span><span class="o">=</span><span class="mf">2.94e-54</span> <span class="o">/</span> <span class="p">(</span><span class="n">MOLEC_CM3_TO_MOLE_M3</span><span class="o">**</span><span class="mi">3</span><span class="p">),</span>
        <span class="n">Ea</span><span class="o">=-</span><span class="mf">4.30762e-20</span><span class="p">)</span>

    <span class="n">rxn_H2O2_OH_HO2_H2O</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Arrhenius</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;H2O2 + OH -&gt; HO2 + H2O&quot;</span><span class="p">,</span>
        <span class="n">reactants</span><span class="o">=</span><span class="p">[</span><span class="n">H2O2</span><span class="p">,</span> <span class="n">OH</span><span class="p">],</span>
        <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">HO2</span><span class="p">,</span> <span class="n">H2O</span><span class="p">],</span>
        <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span><span class="p">,</span>
        <span class="n">A</span><span class="o">=</span><span class="mf">1.8e-12</span> <span class="o">/</span> <span class="n">MOLEC_CM3_TO_MOLE_M3</span><span class="p">)</span>

    <span class="n">rxn_SO2_OH_SO3_HO2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Troe</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SO2 + OH -&gt; SO3 + HO2&quot;</span><span class="p">,</span>
        <span class="n">reactants</span><span class="o">=</span><span class="p">[</span><span class="n">SO2</span><span class="p">,</span> <span class="n">OH</span><span class="p">],</span>
        <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">SO3</span><span class="p">,</span> <span class="n">HO2</span><span class="p">],</span>
        <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span><span class="p">,</span>
        <span class="n">k0_A</span><span class="o">=</span><span class="mf">2.9e-31</span> <span class="o">/</span> <span class="n">MOLEC_CM3_TO_MOLE_M3</span><span class="p">,</span>
        <span class="n">k0_B</span><span class="o">=-</span><span class="mf">4.1</span><span class="p">,</span>
        <span class="n">kinf_A</span><span class="o">=</span><span class="mf">1.7e-12</span> <span class="o">/</span> <span class="n">MOLEC_CM3_TO_MOLE_M3</span><span class="p">,</span>
        <span class="n">kinf_B</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">)</span>

    <span class="n">rxn_SO3_2H2O_H2SO4_H2O</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Arrhenius</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SO3 + 2H2O -&gt; H2SO4 + H2O&quot;</span><span class="p">,</span>
        <span class="n">reactants</span><span class="o">=</span><span class="p">[</span><span class="n">SO3</span><span class="p">,</span> <span class="n">H2O</span><span class="p">,</span> <span class="n">H2O</span><span class="p">],</span>
        <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">H2SO4</span><span class="p">,</span> <span class="n">H2O</span><span class="p">],</span>
        <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span><span class="p">,</span>
        <span class="n">A</span><span class="o">=</span><span class="mf">8.5e-41</span> <span class="o">/</span> <span class="p">(</span><span class="n">MOLEC_CM3_TO_MOLE_M3</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">C</span><span class="o">=</span><span class="mf">6540.0</span><span class="p">)</span>

    <span class="n">rxn_SO2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Emission</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SO2&quot;</span><span class="p">,</span>
        <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">SO2</span><span class="p">],</span>
        <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">mc</span><span class="o">.</span><span class="n">Mechanism</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Sulfate Box Model&quot;</span><span class="p">,</span>
        <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">gas</span><span class="p">],</span>
        <span class="n">reactions</span><span class="o">=</span><span class="p">[</span>
            <span class="n">rxn_2HO2_H2O2</span><span class="p">,</span>
            <span class="n">rxn_2HO2_M_H2O2</span><span class="p">,</span>
            <span class="n">rxn_2HO2_H2O_H2O2</span><span class="p">,</span>
            <span class="n">rxn_2HO2_H2O_M_H2O2</span><span class="p">,</span>
            <span class="n">rxn_H2O2_OH_HO2_H2O</span><span class="p">,</span>
            <span class="n">rxn_SO2_OH_SO3_HO2</span><span class="p">,</span>
            <span class="n">rxn_SO3_2H2O_H2SO4_H2O</span><span class="p">,</span>
            <span class="n">rxn_SO2</span>
        <span class="p">],</span>
        <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="n">HO2</span><span class="p">,</span> <span class="n">H2O2</span><span class="p">,</span> <span class="n">OH</span><span class="p">,</span> <span class="n">SO2</span><span class="p">,</span> <span class="n">SO3</span><span class="p">,</span> <span class="n">H2SO4</span><span class="p">,</span> <span class="n">H2O</span><span class="p">,</span> <span class="n">M</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<p>Next we will setup the carma solver. This is very similar to before.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_carma_solver</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a CARMA solver with the sulfate box model configuration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAParameters</span><span class="p">()</span>
    <span class="n">params</span><span class="o">.</span><span class="n">nz</span> <span class="o">=</span> <span class="n">NUMBER_OF_GRID_CELLS</span>
    <span class="n">params</span><span class="o">.</span><span class="n">nbin</span> <span class="o">=</span> <span class="n">NUMBER_OF_AEROSOL_SECTIONS</span>

    <span class="c1"># Set up a group for sulfate particles</span>
    <span class="n">sulfate_group</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAGroupConfig</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;sulfate&quot;</span><span class="p">,</span>
        <span class="n">shortname</span><span class="o">=</span><span class="s2">&quot;SULF&quot;</span><span class="p">,</span>
        <span class="n">rmin</span><span class="o">=</span><span class="mf">2.0e-10</span><span class="p">,</span>  <span class="c1"># Minimum radius in meters</span>
        <span class="n">rmrat</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># Radius ratio for the group</span>
        <span class="n">swelling_approach</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;algorithm&quot;</span><span class="p">:</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleSwellingAlgorithm</span><span class="o">.</span><span class="n">WEIGHT_PERCENT_H2SO4</span><span class="p">,</span>
            <span class="s2">&quot;composition&quot;</span><span class="p">:</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleSwellingComposition</span><span class="o">.</span><span class="n">NONE</span>
        <span class="p">},</span>
        <span class="n">is_sulfate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">do_drydep</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">params</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sulfate_group</span><span class="p">)</span>

    <span class="c1"># Set up an element for sulfate</span>
    <span class="n">sulfate_element</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAElementConfig</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Sulfate&quot;</span><span class="p">,</span>
        <span class="n">shortname</span><span class="o">=</span><span class="s2">&quot;SULF&quot;</span><span class="p">,</span>
        <span class="n">rho</span><span class="o">=</span><span class="n">DENSITY_SULFATE</span><span class="p">,</span>  <span class="c1"># Density in kg/m³</span>
        <span class="n">itype</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleType</span><span class="o">.</span><span class="n">VOLATILE</span><span class="p">,</span>
        <span class="n">icomposition</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleComposition</span><span class="o">.</span><span class="n">SULFURIC_ACID</span><span class="p">,</span>
        <span class="n">igroup</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Group index for sulfate</span>
    <span class="p">)</span>
    <span class="n">params</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sulfate_element</span><span class="p">)</span>

    <span class="c1"># Set up gases for water and sulfuric acid</span>
    <span class="n">water</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAGasConfig</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Water Vapor&quot;</span><span class="p">,</span>
        <span class="n">shortname</span><span class="o">=</span><span class="s2">&quot;H2O&quot;</span><span class="p">,</span>
        <span class="n">wtmol</span><span class="o">=</span><span class="n">MOLECULAR_MASS_H2O</span><span class="p">,</span>  <span class="c1"># Molar mass of water in kg/mol</span>
        <span class="n">ivaprtn</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">VaporizationAlgorithm</span><span class="o">.</span><span class="n">H2O_MURPHY_2005</span><span class="p">,</span>
        <span class="n">icomposition</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">GasComposition</span><span class="o">.</span><span class="n">H2O</span><span class="p">,</span>
        <span class="n">dgc_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">ds_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">params</span><span class="o">.</span><span class="n">gases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">water</span><span class="p">)</span>

    <span class="n">h2so4</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAGasConfig</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Sulfuric Acid&quot;</span><span class="p">,</span>
        <span class="n">shortname</span><span class="o">=</span><span class="s2">&quot;H2SO4&quot;</span><span class="p">,</span>
        <span class="n">wtmol</span><span class="o">=</span><span class="n">MOLECULAR_MASS_H2SO4</span><span class="p">,</span>  <span class="c1"># Molar mass of sulfuric acid in kg/mol</span>
        <span class="n">ivaprtn</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">VaporizationAlgorithm</span><span class="o">.</span><span class="n">H2SO4_AYERS_1980</span><span class="p">,</span>
        <span class="n">icomposition</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">GasComposition</span><span class="o">.</span><span class="n">H2SO4</span><span class="p">,</span>
        <span class="n">dgc_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">ds_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">params</span><span class="o">.</span><span class="n">gases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h2so4</span><span class="p">)</span>

    <span class="c1"># Add microphysical processes</span>
    <span class="n">h2so4_uptake</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMAGrowthConfig</span><span class="p">(</span>
        <span class="n">ielem</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Element index for sulfate</span>
        <span class="n">igas</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># Gas index for sulfuric acid</span>
    <span class="p">)</span>
    <span class="n">params</span><span class="o">.</span><span class="n">growths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h2so4_uptake</span><span class="p">)</span>

    <span class="n">nucleation</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMANucleationConfig</span><span class="p">(</span>
        <span class="n">ielemfrom</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Element index for sulfate</span>
        <span class="n">ielemto</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Element index for sulfuric acid</span>
        <span class="n">igas</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># Gas index for sulfuric acid</span>
        <span class="n">algorithm</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleNucleationAlgorithm</span><span class="o">.</span><span class="n">HOMOGENEOUS_NUCLEATION</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">params</span><span class="o">.</span><span class="n">nucleations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nucleation</span><span class="p">)</span>

    <span class="n">coagulation</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMACoagulationConfig</span><span class="p">(</span>
        <span class="n">igroup1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Group index for sulfate (from)</span>
        <span class="n">igroup2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Group index for sulfate (from)</span>
        <span class="n">igroup3</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Group index for sulfate (to)</span>
        <span class="n">algorithm</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">ParticleCollectionAlgorithm</span><span class="o">.</span><span class="n">FUCHS</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">params</span><span class="o">.</span><span class="n">coagulations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coagulation</span><span class="p">)</span>

    <span class="c1"># Set initialization options</span>
    <span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">do_substep</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">do_thermo</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">maxretries</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">maxsubsteps</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">dt_threshold</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">params</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">sulfnucl_method</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">SulfateNucleationMethod</span><span class="o">.</span><span class="n">ZHAO_TURCO</span><span class="o">.</span><span class="n">value</span>

    <span class="k">return</span> <span class="n">musica</span><span class="o">.</span><span class="n">carma</span><span class="o">.</span><span class="n">CARMA</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Similarly, we’ll get some conditions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_initial_conditions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes and returns the environmental conditions and chemical species concentrations</span>
<span class="sd">    for a box model simulation.</span>
<span class="sd">    Returns:</span>
<span class="sd">      tuple:</span>
<span class="sd">        - environmental_conditions (dict): Dictionary containing arrays for temperature (K)</span>
<span class="sd">          and pressure (Pa) for each grid cell.</span>
<span class="sd">        - initial_concentrations (dict): Dictionary containing arrays for the initial</span>
<span class="sd">          concentrations (in mol/m^3) of chemical species (&#39;HO2&#39;, &#39;H2O2&#39;, &#39;OH&#39;, &#39;SO2&#39;, &#39;SO3&#39;,</span>
<span class="sd">          &#39;H2SO4&#39;, &#39;H2O&#39;, &#39;M&#39;) for each grid cell.</span>
<span class="sd">    Notes:</span>
<span class="sd">      - The number of grid cells is determined by the constant NUMBER_OF_GRID_CELLS.</span>
<span class="sd">      - Concentrations are calculated using the conversion factor MOLEC_CM3_TO_MOLE_M3.</span>
<span class="sd">      - Some species are initialized to zero concentration.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Set up the vertical grid in CARMA</span>
    <span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="n">deltaz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">100.0</span><span class="p">)</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;vertical_center&quot;</span><span class="p">:</span> <span class="n">zmin</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">NUMBER_OF_GRID_CELLS</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">deltaz</span><span class="p">,</span>
        <span class="s2">&quot;vertical_levels&quot;</span><span class="p">:</span> <span class="n">zmin</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">NUMBER_OF_GRID_CELLS</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">deltaz</span>
    <span class="p">}</span>

    <span class="n">centered_variables</span> <span class="o">=</span> <span class="n">ussa1976</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s2">&quot;vertical_center&quot;</span><span class="p">],</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">])</span>
    <span class="n">edge_variables</span> <span class="o">=</span> <span class="n">ussa1976</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s2">&quot;vertical_levels&quot;</span><span class="p">],</span> <span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">])</span>
    <span class="n">centered_variables</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">centered_variables</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">GAS_CONSTANT</span> <span class="o">*</span> <span class="n">centered_variables</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
    <span class="n">environmental_conditions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">centered_variables</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
        <span class="s2">&quot;pressure&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">centered_variables</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
        <span class="s2">&quot;pressure levels&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">edge_variables</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
        <span class="s2">&quot;air density&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">centered_variables</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="n">initial_concentrations</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;HO2&quot;</span><span class="p">:</span> <span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;air density&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">80.0e-12</span><span class="p">,</span>
        <span class="s2">&quot;H2O2&quot;</span><span class="p">:</span> <span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;air density&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.0e-9</span><span class="p">,</span>
        <span class="s2">&quot;SO2&quot;</span><span class="p">:</span> <span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;air density&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.15e-9</span><span class="p">,</span>
        <span class="s2">&quot;SO3&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUMBER_OF_GRID_CELLS</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
        <span class="s2">&quot;H2SO4&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUMBER_OF_GRID_CELLS</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
        <span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;air density&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.004</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">grid</span><span class="p">,</span> <span class="n">environmental_conditions</span><span class="p">,</span> <span class="n">initial_concentrations</span>
</pre></div>
</div>
</div>
<p>Finally, we’ll run the box model and plot some results</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">run_box_model</span><span class="p">():</span>
    <span class="c1"># Create the mechanism and solvers</span>
    <span class="n">mechanism</span> <span class="o">=</span> <span class="n">create_mechanism</span><span class="p">()</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">MICM</span><span class="p">(</span><span class="n">mechanism</span><span class="o">=</span><span class="n">mechanism</span><span class="p">,</span> <span class="n">solver_type</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">SolverType</span><span class="o">.</span><span class="n">rosenbrock_standard_order</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">create_state</span><span class="p">(</span><span class="n">number_of_grid_cells</span><span class="o">=</span><span class="n">NUMBER_OF_GRID_CELLS</span><span class="p">)</span>

    <span class="n">carma</span> <span class="o">=</span> <span class="n">create_carma_solver</span><span class="p">()</span>

    <span class="c1"># Set initial conditions</span>
    <span class="n">grid</span><span class="p">,</span> <span class="n">environmental_conditions</span><span class="p">,</span> <span class="n">initial_concentrations</span> <span class="o">=</span> <span class="n">get_initial_conditions</span><span class="p">()</span>
    <span class="n">state</span><span class="o">.</span><span class="n">set_conditions</span><span class="p">(</span><span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">],</span> <span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">])</span>
    <span class="n">state</span><span class="o">.</span><span class="n">set_concentrations</span><span class="p">(</span><span class="n">initial_concentrations</span><span class="p">)</span>
    <span class="n">state</span><span class="o">.</span><span class="n">set_user_defined_rate_parameters</span><span class="p">({</span><span class="s2">&quot;EMIS.SO2&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">NUMBER_OF_GRID_CELLS</span><span class="p">,</span> <span class="mf">1.0e-8</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)})</span>

    <span class="c1"># Run the simulation for 6 hours with a timestep of 30 seconds</span>
    <span class="n">time_hours</span> <span class="o">=</span> <span class="mf">2.0</span>
    <span class="n">time_seconds</span> <span class="o">=</span> <span class="n">time_hours</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">3600.0</span><span class="p">)</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">30.0</span><span class="p">)</span>
    <span class="n">num_steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time_seconds</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>

    <span class="c1"># Initialize combined state arrays</span>
    <span class="n">concentrations</span> <span class="o">=</span> <span class="p">[</span><span class="n">state</span><span class="o">.</span><span class="n">get_concentrations</span><span class="p">()]</span>
    <span class="n">current_temperature</span> <span class="o">=</span> <span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">bin_state</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Set up additional CARMA state arrays</span>
    <span class="n">satliq_h2o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">NUMBER_OF_GRID_CELLS</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">satice_h2o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">NUMBER_OF_GRID_CELLS</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">satliq_h2so4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">NUMBER_OF_GRID_CELLS</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">satice_h2so4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">NUMBER_OF_GRID_CELLS</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">last_h2so4_mmr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NUMBER_OF_GRID_CELLS</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i_time</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_steps</span><span class="p">):</span>
        <span class="n">state</span><span class="o">.</span><span class="n">set_conditions</span><span class="p">(</span><span class="n">temperatures</span><span class="o">=</span><span class="n">current_temperature</span><span class="p">,</span> <span class="n">pressures</span><span class="o">=</span><span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">])</span>
        <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
        <span class="n">micm_output</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">get_concentrations</span><span class="p">()</span>

        <span class="n">h2so4_mmr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">micm_output</span><span class="p">[</span><span class="s2">&quot;H2SO4&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">MOLECULAR_MASS_H2SO4</span> <span class="o">/</span> \
            <span class="p">(</span><span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;air density&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">MOLECULAR_MASS_AIR</span><span class="p">)</span>
        <span class="n">h2o_mmr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">micm_output</span><span class="p">[</span><span class="s2">&quot;H2O&quot;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">MOLECULAR_MASS_H2O</span> <span class="o">/</span> \
            <span class="p">(</span><span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;air density&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">MOLECULAR_MASS_AIR</span><span class="p">)</span>

        <span class="n">carma_state</span> <span class="o">=</span> <span class="n">carma</span><span class="o">.</span><span class="n">create_state</span><span class="p">(</span>
            <span class="n">vertical_center</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s2">&quot;vertical_center&quot;</span><span class="p">],</span>
            <span class="n">vertical_levels</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="s2">&quot;vertical_levels&quot;</span><span class="p">],</span>
            <span class="n">temperature</span><span class="o">=</span><span class="n">current_temperature</span><span class="p">,</span>
            <span class="n">pressure</span><span class="o">=</span><span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">],</span>
            <span class="n">pressure_levels</span><span class="o">=</span><span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;pressure levels&quot;</span><span class="p">],</span>
            <span class="n">time</span><span class="o">=</span><span class="n">i_time</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span>
            <span class="n">time_step</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
            <span class="n">latitude</span><span class="o">=-</span><span class="mf">40.0</span><span class="p">,</span>
            <span class="n">longitude</span><span class="o">=-</span><span class="mf">105.0</span><span class="p">,</span>
            <span class="n">specific_humidity</span><span class="o">=</span><span class="n">h2o_mmr</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">bin_state</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bin_state</span> <span class="o">=</span> <span class="n">carma_state</span><span class="o">.</span><span class="n">get_bins</span><span class="p">()</span>
            <span class="n">bin_state</span> <span class="o">=</span> <span class="n">bin_state</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">({</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]})</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">bin_state</span><span class="p">[</span><span class="s2">&quot;mass_mixing_ratio&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">for</span> <span class="n">i_bin</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUMBER_OF_AEROSOL_SECTIONS</span><span class="p">):</span>
            <span class="n">carma_state</span><span class="o">.</span><span class="n">set_bin</span><span class="p">(</span>
                <span class="n">bin_index</span><span class="o">=</span><span class="n">i_bin</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">element_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Sulfate element index</span>
                <span class="n">value</span><span class="o">=</span><span class="n">bin_state</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">i_time</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="n">i_bin</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s2">&quot;mass_mixing_ratio&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">carma_state</span><span class="o">.</span><span class="n">set_gas</span><span class="p">(</span>
            <span class="n">gas_index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Water vapor gas index</span>
            <span class="n">value</span><span class="o">=</span><span class="n">h2o_mmr</span><span class="p">,</span>
            <span class="n">old_mmr</span><span class="o">=</span><span class="n">h2o_mmr</span><span class="p">,</span>
            <span class="n">gas_saturation_wrt_liquid</span><span class="o">=</span><span class="n">satliq_h2o</span><span class="p">,</span>
            <span class="n">gas_saturation_wrt_ice</span><span class="o">=</span><span class="n">satice_h2o</span>
        <span class="p">)</span>
        <span class="n">carma_state</span><span class="o">.</span><span class="n">set_gas</span><span class="p">(</span>
            <span class="n">gas_index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># Sulfuric acid gas index</span>
            <span class="n">value</span><span class="o">=</span><span class="n">h2so4_mmr</span><span class="p">,</span>
            <span class="n">old_mmr</span><span class="o">=</span><span class="n">last_h2so4_mmr</span><span class="p">,</span>
            <span class="n">gas_saturation_wrt_liquid</span><span class="o">=</span><span class="n">satliq_h2so4</span><span class="p">,</span>
            <span class="n">gas_saturation_wrt_ice</span><span class="o">=</span><span class="n">satice_h2so4</span>
        <span class="p">)</span>
        <span class="n">last_h2so4_mmr</span> <span class="o">=</span> <span class="n">h2so4_mmr</span>

        <span class="n">carma_state</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="c1"># Get updated state data from CARMA</span>
        <span class="n">bin_state</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">bin_state</span><span class="p">,</span> <span class="n">carma_state</span><span class="o">.</span><span class="n">get_bins</span><span class="p">()</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="p">[(</span><span class="n">i_time</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span><span class="p">]})],</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>

        <span class="n">gas_state</span><span class="p">,</span> <span class="n">gas_index</span> <span class="o">=</span> <span class="n">carma_state</span><span class="o">.</span><span class="n">get_gases</span><span class="p">()</span>
        <span class="n">micm_output</span><span class="p">[</span><span class="s2">&quot;H2O&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">gas_state</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span>
                <span class="n">gas</span><span class="o">=</span><span class="n">gas_index</span><span class="p">[</span><span class="s2">&quot;H2O&quot;</span><span class="p">])[</span><span class="s2">&quot;gas_mass_mixing_ratio&quot;</span><span class="p">],</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;air density&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">MOLECULAR_MASS_AIR</span> <span class="o">/</span> <span class="n">MOLECULAR_MASS_H2O</span>
        <span class="n">micm_output</span><span class="p">[</span><span class="s2">&quot;H2SO4&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">gas_state</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span>
                <span class="n">gas</span><span class="o">=</span><span class="n">gas_index</span><span class="p">[</span><span class="s2">&quot;H2SO4&quot;</span><span class="p">])[</span><span class="s2">&quot;gas_mass_mixing_ratio&quot;</span><span class="p">],</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="o">*</span> <span class="n">environmental_conditions</span><span class="p">[</span><span class="s2">&quot;air density&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">MOLECULAR_MASS_AIR</span> <span class="o">/</span> <span class="n">MOLECULAR_MASS_H2SO4</span>

        <span class="c1"># save concentrations for output</span>
        <span class="n">concentrations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">micm_output</span><span class="p">)</span>

        <span class="c1"># prepare for next time step</span>
        <span class="n">current_temperature</span> <span class="o">=</span> <span class="n">carma_state</span><span class="o">.</span><span class="n">get_environmental_values</span><span class="p">()[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]</span>
        <span class="n">state</span><span class="o">.</span><span class="n">set_concentrations</span><span class="p">({</span>
            <span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="n">micm_output</span><span class="p">[</span><span class="s2">&quot;H2O&quot;</span><span class="p">],</span>
            <span class="s2">&quot;H2SO4&quot;</span><span class="p">:</span> <span class="n">micm_output</span><span class="p">[</span><span class="s2">&quot;H2SO4&quot;</span><span class="p">]</span>
        <span class="p">})</span>

    <span class="c1"># Collect output data</span>
    <span class="n">concentrations</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">concentrations</span><span class="p">)</span>
    <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">/</span> <span class="mf">3600.0</span>  <span class="c1"># Time in hours</span>

    <span class="k">return</span> <span class="n">concentrations</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">bin_state</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_results</span><span class="p">(</span><span class="n">concentrations</span><span class="p">,</span> <span class="n">times</span><span class="p">,</span> <span class="n">sulfate_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plots the results of the sulfate box model simulation.</span>
<span class="sd">    Args:</span>
<span class="sd">        concentrations (pd.DataFrame): DataFrame containing the concentrations of chemical species over time.</span>
<span class="sd">        times (np.ndarray): Array of time values corresponding to the concentrations.</span>
<span class="sd">        sulfate_data (xr.Dataset): xarray Dataset containing CARMA sulfate data over time.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create a 4-panel plot for H2O, H2SO4, SO2, and HO2 concentrations over time at the first grid cell</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;H2O&quot;</span><span class="p">,</span> <span class="s2">&quot;H2SO4&quot;</span><span class="p">,</span> <span class="s2">&quot;SO2&quot;</span><span class="p">,</span> <span class="s2">&quot;HO2&quot;</span><span class="p">]</span>
    <span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;H2O Concentration (mol/m³)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;H2SO4 Concentration (mol/m³)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SO2 Concentration (mol/m³)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HO2 Concentration (mol/m³)&quot;</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">specie</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">species</span><span class="p">,</span> <span class="n">titles</span><span class="p">):</span>
        <span class="n">conc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="n">specie</span><span class="p">]</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">concentrations</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()]])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">conc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">specie</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Concentration (mol/m³)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (hours)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Plot total sulfate mass mixing ratio (sum over all bins) over time at the first vertical level</span>
    <span class="k">if</span> <span class="n">sulfate_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sulfate_data</span><span class="p">,</span> <span class="s2">&quot;mass_mixing_ratio&quot;</span><span class="p">):</span>
        <span class="n">total_mmr</span> <span class="o">=</span> <span class="n">sulfate_data</span><span class="p">[</span><span class="s2">&quot;mass_mixing_ratio&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">vertical_center</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;bin&quot;</span><span class="p">)</span>
        <span class="n">total_mmr</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Total Sulfate Mass Mixing Ratio (First Vertical Level)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mass Mixing Ratio (kg/kg)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (hours)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SULFATE data structure:&quot;</span><span class="p">,</span> <span class="n">sulfate_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sulfate_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Available variables:&quot;</span><span class="p">,</span>
                <span class="nb">list</span><span class="p">(</span>
                    <span class="n">sulfate_data</span><span class="o">.</span><span class="n">data_vars</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span>
                    <span class="n">sulfate_data</span><span class="p">,</span>
                    <span class="s1">&#39;data_vars&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;No data_vars available&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;Available dimensions:&quot;</span><span class="p">,</span>
                <span class="nb">list</span><span class="p">(</span>
                    <span class="n">sulfate_data</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span>
                    <span class="n">sulfate_data</span><span class="p">,</span>
                    <span class="s1">&#39;dims&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;No dims available&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No SULFATE data available&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">concs</span><span class="p">,</span> <span class="n">plot_times</span><span class="p">,</span> <span class="n">sulfate_data</span> <span class="o">=</span> <span class="n">run_box_model</span><span class="p">()</span>
<span class="n">plot_results</span><span class="p">(</span><span class="n">concs</span><span class="p">,</span> <span class="n">plot_times</span><span class="p">,</span> <span class="n">sulfate_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_7._carma_32_0.png" src="../_images/tutorials_7._carma_32_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_7._carma_32_1.png" src="../_images/tutorials_7._carma_32_1.png" />
</div>
</div>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="6.%20gpu_solver.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Enabling Your GPU for a Solver in MUSICA</p>
      </div>
    </a>
    <a class="right-next"
       href="../api/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">MUSICA API</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Aluminum</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Sulfate">Sulfate</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Sulfates-with-gas-phase-concentrations-from-a-box-model">Sulfates with gas-phase concentrations from a box model</a></li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/tutorials/7. carma.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024-2026, NSF NCAR.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>