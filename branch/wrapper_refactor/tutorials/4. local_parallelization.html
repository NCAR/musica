
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Parallelizing Multiple Grid Cells Locally &#8212; MUSICA 0.12.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=bbe95013" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=f24cbf82"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/4. local_parallelization';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://ncar.github.io/musica/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.12.2';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Parallelizing Multiple Grid Cells on a High-Performance Computing Cluster" href="5.%20hpc_parallelization.html" />
    <link rel="prev" title="User Defined Reactions in MUSICA" href="3.%20user_defined_reactions.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">MUSICA 0.12.2 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    MUSICA API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../citing/index.html">
    Citing MUSICA
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NCAR/musica" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    MUSICA API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../citing/index.html">
    Citing MUSICA
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NCAR/musica" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter0.html">Chapter 0</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter1.html">Chapter 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter2.html">Chapter 2</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.%20multiple_grid_cells.html">Multiple Grid Cells in MUSICA</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.%20hypercube.html">Latin Hypercube Sampling in MUSICA</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.%20user_defined_reactions.html">User Defined Reactions in MUSICA</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Parallelizing Multiple Grid Cells Locally</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.%20hpc_parallelization.html">Parallelizing Multiple Grid Cells on a High-Performance Computing Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.%20gpu_solver.html">Enabling Your GPU for a Solver in MUSICA</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.%20carma.html">Aluminum</a></li>


</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="tutorials.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Parallelizin...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Parallelizing-Multiple-Grid-Cells-Locally">
<h1>Parallelizing Multiple Grid Cells Locally<a class="headerlink" href="#Parallelizing-Multiple-Grid-Cells-Locally" title="Link to this heading">#</a></h1>
<p>As users grow more familiar with MUSICA, they may wish to run simulations with a larger number of grid cells. By default, MUSICA executes on a single CPU core. This tutorial demonstrates how to use <a class="reference external" href="https://docs.dask.org/en/stable/">Dask</a> to parallelize multiple grid cell simulations across multiple CPU cores. The solving of multiple grid cell simulations across multiple CPUs. It builds on the 1.multiple_grid_cells tutorial. Note that this tutorial serves as a proof-of-concept for local Dask
usage as MUSICA is already efficient at solving a low number of grid cells without parallelization.</p>
<section id="1.-Importing-Libraries">
<h2>1. Importing Libraries<a class="headerlink" href="#1.-Importing-Libraries" title="Link to this heading">#</a></h2>
<p>In addition to libraries previously used throughout MUSICA tutorials, this tutorial uses Dask. Note that if you’d like to visualize Dask graphs, you will also need <a class="reference external" href="https://graphviz.org">Graphviz</a> installed.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">musica</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">musica.mechanism_configuration</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dask</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dask</span><span class="w"> </span><span class="kn">import</span> <span class="n">delayed</span><span class="p">,</span> <span class="n">compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dask.distributed</span><span class="w"> </span><span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">LocalCluster</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">qmc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="c1"># This is done to make the arrays more readable</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># This is done to make the arrays more readable</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Creating-a-local-cluster">
<h2>2. Creating a local cluster<a class="headerlink" href="#2.-Creating-a-local-cluster" title="Link to this heading">#</a></h2>
<p>To run MUSICA in parallel locally, first create a Dask LocalCluster and connect a Client. You can adjust n_workers and threads_per_worker depending on your system and workload. Here we use 2 workers because we intend to simulate 2 grid cells in parallel—one per worker. Use the Dashboard link that prints below to visually track your performance.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cluster</span> <span class="o">=</span> <span class="n">LocalCluster</span><span class="p">(</span>
    <span class="n">n_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">threads_per_worker</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">client</span><span class="o">=</span><span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;"> </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px;">Client</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">Client-a051be18-56a3-11f0-8c1e-6e865522305f</p>
        <table style="width: 100%; text-align: left;">

        <tr>

            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> distributed.LocalCluster</td>

        </tr>


            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard: </strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;"></td>
            </tr>


        </table>




            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;">
    </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px; margin-top: 0px;">LocalCluster</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">af541be6</p>
        <table style="width: 100%; text-align: left;">
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;">
                    <strong>Workers:</strong> 2
                </td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong> 2
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong> 32.00 GiB
                </td>
            </tr>

            <tr>
    <td style="text-align: left;"><strong>Status:</strong> running</td>
    <td style="text-align: left;"><strong>Using processes:</strong> True</td>
</tr>


        </table>

        <details>
            <summary style="margin-bottom: 20px;">
                <h3 style="display: inline;">Scheduler Info</h3>
            </summary>

            <div style="">
    <div>
        <div style="width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-9afc8fcd-5807-4865-b429-7c8596674bc0</p>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;">
                        <strong>Comm:</strong> tcp://127.0.0.1:52483
                    </td>
                    <td style="text-align: left;">
                        <strong>Workers:</strong> 0
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong> 0
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong> Just now
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong> 0 B
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <details style="margin-left: 48px;">
        <summary style="margin-bottom: 20px;">
            <h3 style="display: inline;">Workers</h3>
        </summary>


        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 0</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:52490
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:52493/status" target="_blank">http://127.0.0.1:52493/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 16.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:52486
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /var/folders/3_/65138rls3r5c93lzl9dhrb980000gp/T/dask-scratch-space/worker-gkx0pv41
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 1</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:52491
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:52492/status" target="_blank">http://127.0.0.1:52492/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 16.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:52488
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /var/folders/3_/65138rls3r5c93lzl9dhrb980000gp/T/dask-scratch-space/worker-tcn0y8e9
                        </td>
                    </tr>





                </table>
            </details>
            </div>
        </div>


    </details>
</div>

        </details>
    </div>
</div>
            </details>


    </div>
</div></div>
</div>
</section>
<section id="3.-Setting-up-Grid-Cells">
<h2>3. Setting up Grid Cells<a class="headerlink" href="#3.-Setting-up-Grid-Cells" title="Link to this heading">#</a></h2>
<p>Due to the nature of Dask’s <a class="reference external" href="https://docs.dask.org/en/stable/user-interfaces.html?highlight=lazy#laziness-and-computing">lazy evaluation</a> model and its requirement that all objects passed between workers must be picklable, this tutorial follows a slightly different order than 1.multiple_grid_cells.ipynb. In particular, MUSICA components such as the solver, state, and chemical mechanism must be defined within a dask.delayed function defined later in the notebook.By instantiating them inside
the delayed function, we ensure that each Dask worker constructs and uses its own local version, avoiding pickling issues and enabling clean, parallel execution.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_grid_cells</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
<p>To prepare inputs for multiple grid cells, we create a NumPy array with repeated values for temperature, pressure, and species concentrations. Each row represents a distinct grid cell, and the columns represent the physical and chemical variables.</p>
<p>This array is then split into separate variables to initialize the solver’s state. Concentrations are formatted as a dictionary, as required by set_concentrations(), and additional simulation metadata (e.g., time step, simulation length) is initialized. These steps closely follow the logic in steps 5 and 6 of the <a class="reference internal" href="1.%20multiple_grid_cells.html"><span class="doc">Multiple Grid Cells Tutorial</span></a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">box_model_values</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">300</span><span class="p">,</span> <span class="mf">101253.3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="n">box_model_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">box_model_values</span><span class="p">,</span> <span class="n">num_grid_cells</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">box_model_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[   300. , 101253.3,      5. ,      5. ,      5. ],
       [   300. , 101253.3,      5. ,      5. ,      5. ]])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperatures</span> <span class="o">=</span> <span class="n">box_model_values</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">pressures</span> <span class="o">=</span> <span class="n">box_model_values</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">concentrations</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
<span class="n">concentrations</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">box_model_values</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">concentrations</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">box_model_values</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">concentrations</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">box_model_values</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>

<span class="n">concentrations_solved</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">time_step_length</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sim_length</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">curr_time</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</section>
<section id="4.-Creating-a-delayed-function-for-Dask">
<h2>4. Creating a delayed function for Dask<a class="headerlink" href="#4.-Creating-a-delayed-function-for-Dask" title="Link to this heading">#</a></h2>
<p>We define a &#64;delayed function that sets up the Species, Reactions, Mechanism, and Solver for a single grid cell. The function returns the concentrations at each time step. This function also mirrors steps from the <a class="reference internal" href="1.%20multiple_grid_cells.html"><span class="doc">Multiple Grid Cells Tutorial</span></a>, but is structured for Dask compatibility.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@delayed</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve_one_cell</span><span class="p">(</span><span class="n">cell_index</span><span class="p">,</span><span class="n">temperatures</span><span class="p">,</span><span class="n">pressures</span><span class="p">,</span><span class="n">concentrations</span><span class="p">,</span> <span class="n">sim_length</span><span class="p">,</span> <span class="n">time_step</span><span class="p">):</span>

    <span class="c1"># Define the system</span>

    <span class="n">A</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span> <span class="c1"># Create each of the species with their respective names</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">]</span> <span class="c1"># Bundle the species into a list</span>
    <span class="n">gas</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Phase</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;gas&quot;</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">)</span> <span class="c1"># Create a gas phase object containing the species</span>

    <span class="n">r1</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Arrhenius</span><span class="p">(</span> <span class="c1"># Create the reactions with their name, constants, reactants, products, and phase</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A_to_B&quot;</span><span class="p">,</span>
        <span class="n">A</span><span class="o">=</span><span class="mf">4.0e-3</span><span class="p">,</span>  <span class="c1"># Pre-exponential factor</span>
        <span class="n">C</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>      <span class="c1"># Activation energy (units assumed to be K)</span>
        <span class="n">reactants</span><span class="o">=</span><span class="p">[</span><span class="n">A</span><span class="p">],</span>
        <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">B</span><span class="p">],</span>
        <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span>
    <span class="p">)</span>

    <span class="n">r2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Arrhenius</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;B_to_C&quot;</span><span class="p">,</span>
        <span class="n">A</span><span class="o">=</span><span class="mf">4.0e-3</span><span class="p">,</span>
        <span class="n">C</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
        <span class="n">reactants</span><span class="o">=</span><span class="p">[</span><span class="n">B</span><span class="p">],</span>
        <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">C</span><span class="p">],</span>
        <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span>
    <span class="p">)</span>

    <span class="n">mechanism</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Mechanism</span><span class="p">(</span> <span class="c1"># Define the mechanism which contains a name, the species, the phases, and reactions</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;musica_micm_example&quot;</span><span class="p">,</span>
        <span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">,</span>
        <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">gas</span><span class="p">],</span>
        <span class="n">reactions</span><span class="o">=</span><span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">]</span>
<span class="p">)</span>


    <span class="c1">#create the solver</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">MICM</span><span class="p">(</span><span class="n">mechanism</span><span class="o">=</span><span class="n">mechanism</span><span class="p">,</span> <span class="n">solver_type</span><span class="o">=</span><span class="n">musica</span><span class="o">.</span><span class="n">SolverType</span><span class="o">.</span><span class="n">rosenbrock_standard_order</span><span class="p">)</span>

    <span class="c1">#create the state</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">create_state</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">state</span><span class="o">.</span><span class="n">set_conditions</span><span class="p">(</span><span class="n">temperatures</span><span class="p">[</span><span class="n">cell_index</span><span class="p">],</span><span class="n">pressures</span><span class="p">[</span><span class="n">cell_index</span><span class="p">])</span>
    <span class="n">cur_concentrations</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="p">[</span><span class="n">cell_index</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">concentrations</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="n">state</span><span class="o">.</span><span class="n">set_concentrations</span><span class="p">(</span><span class="n">cur_concentrations</span><span class="p">)</span>

    <span class="n">time</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">track_time</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">time</span> <span class="o">&lt;=</span> <span class="n">sim_length</span><span class="p">:</span>
        <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get_concentrations</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">track_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">time</span> <span class="o">+=</span> <span class="n">time_step</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;times&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">track_time</span><span class="p">),</span>
        <span class="s2">&quot;concentrations&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="p">}</span>
<br/></pre></div>
</div>
</div>
</section>
<section id="5.-Solving">
<h2>5. Solving<a class="headerlink" href="#5.-Solving" title="Link to this heading">#</a></h2>
<p>We use a Python list comprehension to create one delayed task per grid cell. Each call to solve_one_cell(…) returns a Dask Delayed object, which represents a unit of work that hasn’t been executed yet. These tasks are stored in the tasks list and will be executed in parallel when we call compute().</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dispatch one task per grid cell</span>
<span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">solve_one_cell</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">temperatures</span><span class="p">,</span><span class="n">pressures</span><span class="p">,</span><span class="n">concentrations</span><span class="p">,</span> <span class="n">sim_length</span><span class="p">,</span> <span class="n">time_step_length</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_grid_cells</span><span class="p">)]</span>
<span class="c1"># visualize the Dask graph</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">compute</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">)</span>
<span class="n">dask</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_4._local_parallelization_19_0.png" src="../_images/tutorials_4._local_parallelization_19_0.png" />
</div>
</div>
</section>
<section id="6.-Visualizing-Results">
<h2>6. Visualizing Results<a class="headerlink" href="#6.-Visualizing-Results" title="Link to this heading">#</a></h2>
<p>As in the <a class="reference internal" href="1.%20multiple_grid_cells.html"><span class="doc">Multiple Grid Cells Tutorial</span></a>, the results can now be visualized over time and are consistent with those obtained without using Dask.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract the array from the tuple</span>
<span class="n">time_array</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;times&#39;</span><span class="p">]</span>
<span class="n">data_array</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;concentrations&#39;</span><span class="p">]</span>

<span class="c1"># Flatten the single-element lists in each dictionary</span>
<span class="n">flat_dicts</span> <span class="o">=</span> <span class="p">[{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data_array</span><span class="p">]</span>

<span class="c1"># Convert to DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">flat_dicts</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;time.s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_array</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;times&#39;</span><span class="p">]</span>

<span class="c1">#rename columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="s1">&#39;CONC.A.mol m-3&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="s1">&#39;CONC.B.mol m-3&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="s1">&#39;CONC.C.mol m-3&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Show the result</span>
<span class="c1"># Show all rows</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1">#plot</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time.s&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CONC.A.mol m-3&#39;</span><span class="p">,</span> <span class="s1">&#39;CONC.B.mol m-3&#39;</span><span class="p">,</span> <span class="s1">&#39;CONC.C.mol m-3&#39;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Concentration over time&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Concentration (mol m-3)&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CONC.A.mol m-3</th>
      <th>CONC.B.mol m-3</th>
      <th>CONC.C.mol m-3</th>
      <th>time.s</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.976428528398802</td>
      <td>4.999944351093875</td>
      <td>5.0236271205073235</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.929618429433882</td>
      <td>4.999502304184354</td>
      <td>5.070879266381759</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.860227571898497</td>
      <td>4.998027906909858</td>
      <td>5.141744521191641</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.769223461910271</td>
      <td>4.994590343685047</td>
      <td>5.236186194404681</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4.657860795721631</td>
      <td>4.988017567302154</td>
      <td>5.3541216369762115</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>4.527652679026353</td>
      <td>4.9769510981867855</td>
      <td>5.49539622278686</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>4.380336435836852</td>
      <td>4.959909340283517</td>
      <td>5.65975422387963</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4.217835086228851</td>
      <td>4.935356388404806</td>
      <td>5.846808525366342</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4.042215685186966</td>
      <td>4.901773090409533</td>
      <td>6.056011224403497</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3.855645780447624</td>
      <td>4.857727088113415</td>
      <td>6.28662713143896</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>3.6603492643036737</td>
      <td>4.801938691142486</td>
      <td>6.537712044553839</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>3.458562863787737</td>
      <td>4.733339725758781</td>
      <td>6.808097410453479</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>3.252494610512199</td>
      <td>4.651122489164782</td>
      <td>7.096382900323015</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>3.0442846925682847</td>
      <td>4.554778598766272</td>
      <td>7.400936708665442</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2.8359704984770615</td>
      <td>4.444124054435992</td>
      <td>7.719905447086947</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2.6294560693405855</td>
      <td>4.3193112630886885</td>
      <td>8.051232667570726</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2.426486586564641</td>
      <td>4.180827795709497</td>
      <td>8.392685617725858</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2.228628262140719</td>
      <td>4.029482439264608</td>
      <td>8.741889298594673</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2.0372537853108215</td>
      <td>3.866379699486838</td>
      <td>9.096366515202343</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.8535332921332346</td>
      <td>3.6928843685085195</td>
      <td>9.453582339358244</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>1.6784306527893238</td>
      <td>3.5105781208300084</td>
      <td>9.810991226380661</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1.5127047211405233</td>
      <td>3.321210331143579</td>
      <td>10.166084947715891</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>1.356915066356869</td>
      <td>3.1266454146790843</td>
      <td>10.51643951896404</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1.2114316101722387</td>
      <td>2.9288089788390224</td>
      <td>10.859759410988733</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>1.0764475267344704</td>
      <td>2.729634954205287</td>
      <td>11.19391751906024</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0.9519947249254646</td>
      <td>2.5310156590366075</td>
      <td>11.51698961603792</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0.837961223947276</td>
      <td>2.3347564634880977</td>
      <td>11.82728231256462</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.7341097493324982</td>
      <td>2.1425363796482437</td>
      <td>12.123353871019258</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.6400969149160579</td>
      <td>1.9558755335759015</td>
      <td>12.40402755150804</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.5554924126827311</td>
      <td>1.7761100976759248</td>
      <td>12.668397489641347</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.4797977024313251</td>
      <td>1.6043748959616275</td>
      <td>12.915827401607048</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.41246377244198124</td>
      <td>1.4415935581573638</td>
      <td>13.145942669400656</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0.35290762650931823</td>
      <td>1.2884758048037372</td>
      <td>13.358616568686944</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>34</th>
      <td>0.30052723785431357</td>
      <td>1.1455212042292484</td>
      <td>13.55395155791644</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>35</th>
      <td>0.2547147930736237</td>
      <td>1.0130285591192634</td>
      <td>13.732256647807118</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>36</th>
      <td>0.21486812652973247</td>
      <td>0.8911099572756886</td>
      <td>13.894021916194585</td>
      <td>36.0</td>
    </tr>
    <tr>
      <th>37</th>
      <td>0.18040031517217622</td>
      <td>0.7797084563927418</td>
      <td>14.039891228435092</td>
      <td>37.0</td>
    </tr>
    <tr>
      <th>38</th>
      <td>0.15074746410949966</td>
      <td>0.678618361746843</td>
      <td>14.170634174143665</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0.12537476336137934</td>
      <td>0.5875070918377543</td>
      <td>14.287118144800878</td>
      <td>39.0</td>
    </tr>
    <tr>
      <th>40</th>
      <td>0.1037809357360195</td>
      <td>0.5059377019084463</td>
      <td>14.390281362355545</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>41</th>
      <td>0.08550122484003099</td>
      <td>0.4333912397547042</td>
      <td>14.481107535405275</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>42</th>
      <td>0.07010909140420013</td>
      <td>0.36928823295778984</td>
      <td>14.560602675638018</td>
      <td>42.0</td>
    </tr>
    <tr>
      <th>43</th>
      <td>0.0572167962977099</td>
      <td>0.3130087426444584</td>
      <td>14.629774461057835</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>44</th>
      <td>0.04647505093834706</td>
      <td>0.2639105579237306</td>
      <td>14.689614391137928</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>45</th>
      <td>0.037571911560932474</td>
      <td>0.2213452402398352</td>
      <td>14.741082848199234</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>0.030231084311409015</td>
      <td>0.18467185233856923</td>
      <td>14.785097063350019</td>
      <td>46.0</td>
    </tr>
    <tr>
      <th>47</th>
      <td>0.024209794704965863</td>
      <td>0.15326831813561934</td>
      <td>14.822521887159413</td>
      <td>47.0</td>
    </tr>
    <tr>
      <th>48</th>
      <td>0.01929635886444594</td>
      <td>0.12654045469718583</td>
      <td>14.854163186438367</td>
      <td>48.0</td>
    </tr>
    <tr>
      <th>49</th>
      <td>0.015307576263053525</td>
      <td>0.10392879432885158</td>
      <td>14.880763629408094</td>
      <td>49.0</td>
    </tr>
    <tr>
      <th>50</th>
      <td>0.012086045407999296</td>
      <td>0.08491337312980626</td>
      <td>14.903000581462189</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>51</th>
      <td>0.00949748582941424</td>
      <td>0.06901670299746232</td>
      <td>14.921485811173119</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>52</th>
      <td>0.007428132522030055</td>
      <td>0.05580516841273506</td>
      <td>14.936766699065231</td>
      <td>52.0</td>
    </tr>
    <tr>
      <th>53</th>
      <td>0.005782253100782559</td>
      <td>0.0448890993856103</td>
      <td>14.949328647513605</td>
      <td>53.0</td>
    </tr>
    <tr>
      <th>54</th>
      <td>0.00447982369715577</td>
      <td>0.03592177000563525</td>
      <td>14.959598406297205</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>55</th>
      <td>0.003454387225865738</td>
      <td>0.028597560570059688</td>
      <td>14.96794805220407</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>56</th>
      <td>0.002651107160467822</td>
      <td>0.022649502677897917</td>
      <td>14.974699390161629</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>57</th>
      <td>0.0020250213465128905</td>
      <td>0.017846403257376808</td>
      <td>14.980128575396103</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>58</th>
      <td>0.0015394935543717359</td>
      <td>0.013989717274570492</td>
      <td>14.984470789171048</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>59</th>
      <td>0.0011648552812954611</td>
      <td>0.010910311593626494</td>
      <td>14.987924833125069</td>
      <td>59.0</td>
    </tr>
    <tr>
      <th>60</th>
      <td>0.000877226570820777</td>
      <td>0.008465235540415051</td>
      <td>14.990657537888755</td>
      <td>60.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_4._local_parallelization_22_1.png" src="../_images/tutorials_4._local_parallelization_22_1.png" />
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3.%20user_defined_reactions.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">User Defined Reactions in MUSICA</p>
      </div>
    </a>
    <a class="right-next"
       href="5.%20hpc_parallelization.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Parallelizing Multiple Grid Cells on a High-Performance Computing Cluster</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#1.-Importing-Libraries">1. Importing Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#2.-Creating-a-local-cluster">2. Creating a local cluster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#3.-Setting-up-Grid-Cells">3. Setting up Grid Cells</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#4.-Creating-a-delayed-function-for-Dask">4. Creating a delayed function for Dask</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#5.-Solving">5. Solving</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#6.-Visualizing-Results">6. Visualizing Results</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/tutorials/4. local_parallelization.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024-2025, NSF NCAR.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>