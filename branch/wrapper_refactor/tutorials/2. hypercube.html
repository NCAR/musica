
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Latin Hypercube Sampling in MUSICA &#8212; MUSICA 0.12.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=bbe95013" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=f24cbf82"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/2. hypercube';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://ncar.github.io/musica/_static/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.12.2';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="User Defined Reactions in MUSICA" href="3.%20user_defined_reactions.html" />
    <link rel="prev" title="Multiple Grid Cells in MUSICA" href="1.%20multiple_grid_cells.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">MUSICA 0.12.2 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    MUSICA API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../citing/index.html">
    Citing MUSICA
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NCAR/musica" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    MUSICA API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing/index.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../citing/index.html">
    Citing MUSICA
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NCAR/musica" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter0.html">Chapter 0</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter1.html">Chapter 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter2.html">Chapter 2</a></li>
</ul>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.%20multiple_grid_cells.html">Multiple Grid Cells in MUSICA</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Latin Hypercube Sampling in MUSICA</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.%20user_defined_reactions.html">User Defined Reactions in MUSICA</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.%20local_parallelization.html">Parallelizing Multiple Grid Cells Locally</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.%20hpc_parallelization.html">Parallelizing Multiple Grid Cells on a High-Performance Computing Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.%20gpu_solver.html">Enabling Your GPU for a Solver in MUSICA</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.%20carma.html">Aluminum</a></li>


</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="tutorials.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Latin...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Latin-Hypercube-Sampling-in-MUSICA">
<h1>Latin Hypercube Sampling in MUSICA<a class="headerlink" href="#Latin-Hypercube-Sampling-in-MUSICA" title="Link to this heading">#</a></h1>
<p>In the previous example, all of the grid cells had to be filled in manually with data. This makes it not practically useful on its own since it would be tedious to make a system with many grid cells. One solution to this is Latin Hypercube Sampling (LHS), a statistical method for generating multidimensional random samples. It avoids the problem of clustering that can sometimes appear in pure random sampling. This tutorial will go over a simple example of utilizing LHS to run a multi-grid-cell
solver in MUSICA. For documentation on Latin Hypercube Sampling, go <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.qmc.LatinHypercube.html">here</a>.</p>
<section id="1.-Importing-Libraries">
<h2>1. Importing Libraries<a class="headerlink" href="#1.-Importing-Libraries" title="Link to this heading">#</a></h2>
<p>Below is a list of the required libraries for this tutorial:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">musica</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">musica.mechanism_configuration</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">qmc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.float_format&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="c1"># This is done to make the arrays more readable</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># This is done to make the arrays more readable</span>
</pre></div>
</div>
</div>
</section>
<section id="2.-Rerunning-Previous-Code">
<h2>2. Rerunning Previous Code<a class="headerlink" href="#2.-Rerunning-Previous-Code" title="Link to this heading">#</a></h2>
<p>This is simply a copy of the first 4 steps from the <a class="reference internal" href="1.%20multiple_grid_cells.html"><span class="doc">Multiple Grid Cells Tutorial</span></a> since the code is identical aside from the number of grid cells being increased. If you would like to view the explanation for this code, refer to the hyperlink on the above line.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Species</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
<span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">]</span>
<span class="n">gas</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Phase</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;gas&quot;</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">)</span>

<span class="n">r1</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Arrhenius</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;A_to_B&quot;</span><span class="p">,</span>
    <span class="n">A</span><span class="o">=</span><span class="mf">4.0e-3</span><span class="p">,</span>  <span class="c1"># Pre-exponential factor</span>
    <span class="n">C</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>      <span class="c1"># Activation energy (units assumed to be K)</span>
    <span class="n">reactants</span><span class="o">=</span><span class="p">[</span><span class="n">A</span><span class="p">],</span>
    <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">B</span><span class="p">],</span>
    <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span>
<span class="p">)</span>

<span class="n">r2</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Arrhenius</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;B_to_C&quot;</span><span class="p">,</span>
    <span class="n">A</span><span class="o">=</span><span class="mf">4.0e-3</span><span class="p">,</span>
    <span class="n">C</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">reactants</span><span class="o">=</span><span class="p">[</span><span class="n">B</span><span class="p">],</span>
    <span class="n">products</span><span class="o">=</span><span class="p">[</span><span class="n">C</span><span class="p">],</span>
    <span class="n">gas_phase</span><span class="o">=</span><span class="n">gas</span>
<span class="p">)</span>

<span class="n">mechanism</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">Mechanism</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;musica_micm_example&quot;</span><span class="p">,</span>
    <span class="n">species</span><span class="o">=</span><span class="n">species</span><span class="p">,</span>
    <span class="n">phases</span><span class="o">=</span><span class="p">[</span><span class="n">gas</span><span class="p">],</span>
    <span class="n">reactions</span><span class="o">=</span><span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">solver</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">MICM</span><span class="p">(</span><span class="n">mechanism</span> <span class="o">=</span> <span class="n">mechanism</span><span class="p">,</span> <span class="n">solver_type</span> <span class="o">=</span> <span class="n">musica</span><span class="o">.</span><span class="n">SolverType</span><span class="o">.</span><span class="n">rosenbrock_standard_order</span><span class="p">)</span>

<span class="n">num_grid_cells</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">create_state</span><span class="p">(</span><span class="n">num_grid_cells</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="3.-Creating-and-Scaling-a-Latin-Hypercube-Sampler">
<h2>3. Creating and Scaling a Latin Hypercube Sampler<a class="headerlink" href="#3.-Creating-and-Scaling-a-Latin-Hypercube-Sampler" title="Link to this heading">#</a></h2>
<p>This Latin Hypercube Sampler uses the same 5 dimensions as the <a class="reference internal" href="1.%20multiple_grid_cells.html"><span class="doc">Multiple Grid Cells Tutorial</span></a> to randomize each of the individual systems, being:</p>
<ul class="simple">
<li><p>temperature (Kelvin),</p></li>
<li><p>pressure (Pascals), and</p></li>
<li><p>the concentrations of each of the species (mol/m3).</p></li>
</ul>
<p>Next, the LHS is created with the provided number of dimensions with a randomized sample that will be scaled by the sampler. The upper and lower bounds for each of the five dimensions are then set, and the sample is scaled with those bounds by the LHS. Do note as before that the ordering inside the bounding arrays matters and cannot be changed.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ndim</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">nsamples</span> <span class="o">=</span> <span class="n">num_grid_cells</span>

<span class="c1"># Create a Latin Hypercube sampler in the unit hypercube</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">qmc</span><span class="o">.</span><span class="n">LatinHypercube</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">ndim</span><span class="p">)</span>

<span class="c1"># Generate samples</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">nsamples</span><span class="p">)</span>

<span class="c1"># Define bounds for each dimension</span>
<span class="n">l_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">275</span><span class="p">,</span> <span class="mf">100753.3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># Lower bounds</span>
<span class="n">u_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">325</span><span class="p">,</span> <span class="mf">101753.3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="c1"># Upper bounds</span>

<span class="c1"># Scale the samples to the defined bounds</span>
<span class="n">sample_scaled</span> <span class="o">=</span> <span class="n">qmc</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">l_bounds</span><span class="p">,</span> <span class="n">u_bounds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="4.-Splitting-up-the-Array-Output-and-Running-the-Solver">
<h2>4. Splitting up the Array Output and Running the Solver<a class="headerlink" href="#4.-Splitting-up-the-Array-Output-and-Running-the-Solver" title="Link to this heading">#</a></h2>
<p>This code follows the same flow as the <a class="reference internal" href="1.%20multiple_grid_cells.html"><span class="doc">Multiple Grid Cells Tutorial</span></a> but with the new LHS values. The only notable change is the old box_model_values array becoming the sample_scaled output array from the LHS.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperatures</span> <span class="o">=</span> <span class="n">sample_scaled</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">pressures</span> <span class="o">=</span> <span class="n">sample_scaled</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">concentrations</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
<span class="n">concentrations</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_scaled</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">concentrations</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_scaled</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">concentrations</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_scaled</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>

<span class="n">state</span><span class="o">.</span><span class="n">set_conditions</span><span class="p">(</span><span class="n">temperatures</span><span class="p">,</span> <span class="n">pressures</span><span class="p">)</span>
<span class="n">state</span><span class="o">.</span><span class="n">set_concentrations</span><span class="p">(</span><span class="n">concentrations</span><span class="p">)</span>
<span class="n">concentrations_solved</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">time_step_length</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sim_length</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">curr_time</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="n">curr_time</span> <span class="o">&lt;=</span> <span class="n">sim_length</span><span class="p">:</span>
    <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">curr_time</span><span class="p">)</span>
    <span class="n">concentrations_solved</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get_concentrations</span><span class="p">())</span>
    <span class="n">curr_time</span> <span class="o">+=</span> <span class="n">time_step_length</span>
</pre></div>
</div>
</div>
</section>
<section id="5.-Expanding-out-the-DataFrame-(Advanced;-Optional-Read)">
<h2>5. Expanding out the DataFrame (Advanced; Optional Read)<a class="headerlink" href="#5.-Expanding-out-the-DataFrame-(Advanced;-Optional-Read)" title="Link to this heading">#</a></h2>
<p>The intention of this code snippet is to split up each grid cell for each time step onto a separate row in the DataFrame so they can be averaged when plotted. This will produce a confidence interval for each time step since there will be a set of unique values at every time step for each species. As an example, if there are 2 grid cells and 5 time steps, the data table will have 10 rows, with the first being the first grid cell for the first time step, the second row being the second grid cell
for the first time step, the third row being the first grid cell for the second time step, and so on. You can see this pattern in the displayed DataFrame as well. After the expansion of the DataFrame, adding the other columns is fairly similar; they are simply given more rows since the number of rows is now the product of the number of grid cells and the number of time steps. The time column is notably different, however, since each time step has to be repeated for every grid cell. Due to the
complexity of this code cell, it has been bundled into a function which is then called. Once that is all done, the expanded DataFrame is displayed. Note that the first column is the index of the DataFrame, not the time step here.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">convert_results_all_cells</span><span class="p">():</span>
    <span class="n">concentrations_solved_pd</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">time</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sim_length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">time_step_length</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_grid_cells</span><span class="p">):</span>
            <span class="n">concentrations_solved_pd</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">species</span><span class="p">:</span> <span class="n">concentration</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="n">concentration</span> <span class="ow">in</span> <span class="n">concentrations_solved</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">time_step_length</span><span class="p">)]</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
            <span class="n">time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">concentrations_solved_pd</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span> <span class="p">:</span> <span class="s1">&#39;CONC.A.mol m-3&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span> <span class="p">:</span> <span class="s1">&#39;CONC.B.mol m-3&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span> <span class="p">:</span> <span class="s1">&#39;CONC.C.mol m-3&#39;</span><span class="p">})</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;time.s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ENV.temperature.K&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">temperatures</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">sim_length</span><span class="o">/</span><span class="n">time_step_length</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_grid_cells</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ENV.pressure.Pa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">pressures</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">sim_length</span><span class="o">/</span><span class="n">time_step_length</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_grid_cells</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ENV.air number density.mol m-3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">get_conditions</span><span class="p">()[</span><span class="s1">&#39;air_density&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">sim_length</span><span class="o">/</span><span class="n">time_step_length</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">num_grid_cells</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;time.s&#39;</span><span class="p">,</span> <span class="s1">&#39;ENV.temperature.K&#39;</span><span class="p">,</span> <span class="s1">&#39;ENV.pressure.Pa&#39;</span><span class="p">,</span> <span class="s1">&#39;ENV.air number density.mol m-3&#39;</span><span class="p">,</span> <span class="s1">&#39;CONC.A.mol m-3&#39;</span><span class="p">,</span> <span class="s1">&#39;CONC.B.mol m-3&#39;</span><span class="p">,</span> <span class="s1">&#39;CONC.C.mol m-3&#39;</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">concentrations_solved_pd</span><span class="p">,</span> <span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">concentrations_solved_pd</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="n">convert_results_all_cells</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time.s</th>
      <th>ENV.temperature.K</th>
      <th>ENV.pressure.Pa</th>
      <th>ENV.air number density.mol m-3</th>
      <th>CONC.A.mol m-3</th>
      <th>CONC.B.mol m-3</th>
      <th>CONC.C.mol m-3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>286.00321749782404</td>
      <td>101281.96283938194</td>
      <td>42.59189914230601</td>
      <td>9.603213213571069</td>
      <td>9.101503007047965</td>
      <td>1.3791552759048176</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>286.00321749782404</td>
      <td>101281.96283938194</td>
      <td>42.59189914230601</td>
      <td>6.316518664406818</td>
      <td>3.5442239182495494</td>
      <td>7.5309574382359585</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>286.00321749782404</td>
      <td>101281.96283938194</td>
      <td>42.59189914230601</td>
      <td>7.60797163127235</td>
      <td>4.98172822290733</td>
      <td>8.77528825739052</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>286.00321749782404</td>
      <td>101281.96283938194</td>
      <td>42.59189914230601</td>
      <td>2.15189275842202</td>
      <td>4.182414864738023</td>
      <td>8.078019549492074</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>286.00321749782404</td>
      <td>101281.96283938194</td>
      <td>42.59189914230601</td>
      <td>9.209637754005923</td>
      <td>5.905763265736759</td>
      <td>3.133282102633176</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6095</th>
      <td>60</td>
      <td>286.00321749782404</td>
      <td>101281.96283938194</td>
      <td>42.59189914230601</td>
      <td>0.0006042084606455776</td>
      <td>0.005697973414917429</td>
      <td>9.121982643142896</td>
    </tr>
    <tr>
      <th>6096</th>
      <td>60</td>
      <td>286.00321749782404</td>
      <td>101281.96283938194</td>
      <td>42.59189914230601</td>
      <td>0.0017057891805664078</td>
      <td>0.01528585497949259</td>
      <td>17.78465003247812</td>
    </tr>
    <tr>
      <th>6097</th>
      <td>60</td>
      <td>286.00321749782404</td>
      <td>101281.96283938194</td>
      <td>42.59189914230601</td>
      <td>0.0006216717116591639</td>
      <td>0.00551919020208598</td>
      <td>13.319388770527299</td>
    </tr>
    <tr>
      <th>6098</th>
      <td>60</td>
      <td>286.00321749782404</td>
      <td>101281.96283938194</td>
      <td>42.59189914230601</td>
      <td>0.0007354727081189604</td>
      <td>0.007513964364701525</td>
      <td>15.431405934122955</td>
    </tr>
    <tr>
      <th>6099</th>
      <td>60</td>
      <td>286.00321749782404</td>
      <td>101281.96283938194</td>
      <td>42.59189914230601</td>
      <td>0.00011133657751124476</td>
      <td>0.0026815740270777354</td>
      <td>12.495870560349145</td>
    </tr>
  </tbody>
</table>
<p>6100 rows × 7 columns</p>
</div></div>
</div>
</section>
<section id="6.-Visualizing-the-Results">
<h2>6. Visualizing the Results<a class="headerlink" href="#6.-Visualizing-the-Results" title="Link to this heading">#</a></h2>
<p>This set of steps involves plotting the results after running the solver for the LHS data. There will be two plots, one containing the mean concentration for each species and their respective 95% confidence interval, and one for each species’ concentration range.</p>
<section id="6a.-Visualizing-the-Confidence-Interval">
<h3>6a. Visualizing the Confidence Interval<a class="headerlink" href="#6a.-Visualizing-the-Confidence-Interval" title="Link to this heading">#</a></h3>
<p>Here, the three species are plotted out with Seaborn’s lineplot() function, which takes in an input x and y variable with the 95% confidence interval (CI) displayed. There are additional parameters passed in as well, such as the CI value, which can be changed from 95, and setting the alpha so that the CI is more visible. Since the DataFrame has more than one value for each time step (x-axis), the solid line represents the mean of the species’ concentrations at every time step.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;time.s&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CONC.A.mol m-3&#39;</span><span class="p">,</span> <span class="n">errorbar</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ci&#39;</span><span class="p">,</span> <span class="mi">95</span><span class="p">),</span> <span class="n">err_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span> <span class="p">:</span> <span class="mf">0.4</span><span class="p">},</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CONC.A.mol m-3&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;time.s&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CONC.B.mol m-3&#39;</span><span class="p">,</span> <span class="n">errorbar</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ci&#39;</span><span class="p">,</span> <span class="mi">95</span><span class="p">),</span> <span class="n">err_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span> <span class="p">:</span> <span class="mf">0.4</span><span class="p">},</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CONC.B.mol m-3&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;time.s&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;CONC.C.mol m-3&#39;</span><span class="p">,</span> <span class="n">errorbar</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ci&#39;</span><span class="p">,</span> <span class="mi">95</span><span class="p">),</span> <span class="n">err_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span> <span class="p">:</span> <span class="mf">0.4</span><span class="p">},</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CONC.C.mol m-3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average concentration with CI over time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mol m-3)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2._hypercube_14_0.png" src="../_images/tutorials_2._hypercube_14_0.png" />
</div>
</div>
</section>
<section id="6b.-Visualizing-the-Min-Max-Curve">
<h3>6b. Visualizing the Min-Max Curve<a class="headerlink" href="#6b.-Visualizing-the-Min-Max-Curve" title="Link to this heading">#</a></h3>
<p>This figure is similar to the CI curves above, but it instead displays the range of values for each species at each time step. To build this figure, the min and max at every time step are found and populated into their respective arrays to represent the bottom curve and top curve for each species. All of the curves are then plotted for each species with a lower alpha so that the overlaps are visible.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">max_y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sim_length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">time_step_length</span><span class="p">):</span>
    <span class="n">min_y</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">species</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">concentration</span><span class="p">)</span> <span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="n">concentration</span> <span class="ow">in</span> <span class="n">concentrations_solved</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">time_step_length</span><span class="p">)]</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
    <span class="n">max_y</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">species</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">concentration</span><span class="p">)</span> <span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="n">concentration</span> <span class="ow">in</span> <span class="n">concentrations_solved</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="n">time_step_length</span><span class="p">)]</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
<span class="n">time_x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sim_length</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">time_step_length</span><span class="p">)))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time_x</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">min_y</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">max_y</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CONC.A.mol m-3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time_x</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">min_y</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">max_y</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CONC.B.mol m-3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">time_x</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">min_y</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">max_y</span><span class="p">],</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CONC.C.mol m-3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Concentration range over time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Concentration (mol m-3)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_2._hypercube_16_0.png" src="../_images/tutorials_2._hypercube_16_0.png" />
</div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="1.%20multiple_grid_cells.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Multiple Grid Cells in MUSICA</p>
      </div>
    </a>
    <a class="right-next"
       href="3.%20user_defined_reactions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">User Defined Reactions in MUSICA</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#1.-Importing-Libraries">1. Importing Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#2.-Rerunning-Previous-Code">2. Rerunning Previous Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#3.-Creating-and-Scaling-a-Latin-Hypercube-Sampler">3. Creating and Scaling a Latin Hypercube Sampler</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#4.-Splitting-up-the-Array-Output-and-Running-the-Solver">4. Splitting up the Array Output and Running the Solver</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#5.-Expanding-out-the-DataFrame-(Advanced;-Optional-Read)">5. Expanding out the DataFrame (Advanced; Optional Read)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#6.-Visualizing-the-Results">6. Visualizing the Results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#6a.-Visualizing-the-Confidence-Interval">6a. Visualizing the Confidence Interval</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#6b.-Visualizing-the-Min-Max-Curve">6b. Visualizing the Min-Max Curve</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/tutorials/2. hypercube.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024-2025, NSF NCAR.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>